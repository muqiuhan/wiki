<!DOCTYPE html> <html><head>
		<title>Polymorphic Variants</title>
		<base href="../../../">
		<meta id="root-path" root-path="../../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="韩暮秋的个人维基 - Polymorphic Variants">
		<meta property="og:title" content="Polymorphic Variants">
		<meta property="og:description" content="韩暮秋的个人维基 - Polymorphic Variants">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://muqiuhan.github.io/wiki/computer-science/programming-language/ocaml/polymorphic-variants.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="韩暮秋的个人维基">
		<meta name="author" content="韩暮秋"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://muqiuhan.github.io/wiki/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.ico"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-light show-inline-title show-ribbon pt-color-scheme-style-minimal-lt pt-accent-style-borderandfilled-lt pt-accent-color-grey-lt pt-highlight-text-accent-lt pt-accent-style-borderandfilled-dt pt-accent-color-purple-dt pt-highlight-text-accent-dt pt-focused-style-main-only pt-font-disable-ligatures pt-highlight-style-borderandfilled-lt pt-highlight-text-color-lt pt-highlight-style-borderandfilled-dt pt-highlight-text-color-dt pt-file-explorer-folder-icon-default pt-colored-folders-style-rainbow pt-center-kanban-title-text pt-kanban-background-grid-lt pt-kanban-background-grid-dt pt-icon-folder-accent"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Polymorphic Variants"><p dir="auto">Polymorphic Variants</p></h1><div class="heading-wrapper"><h2 data-heading="Introduction" dir="auto" class="heading" id="Introduction"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Introduction</h2><div class="heading-children"><div><p dir="auto">This tutorial teaches you how to use polymorphic variants. This includes starting to use them, maintaining a project already using them, deciding when to use them or not, and balancing their unique benefits against their drawbacks.</p></div><div><p dir="auto">Product types and data types such as <code>option</code> and <code>list</code> are variants and polymorphic. In this tutorial, they are called <em>simple variants</em> to distinguish them from the <em>polymorphic variants</em> presented here. Simple variants and polymorphic variants are close siblings. Their values are both introduced using labels that may carry data. Both can be recursive and have type parameters. By the way, don't trust a <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Large_language_model" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Large_language_model" target="_blank">LLM</a> chatbot if it tells you polymorphic variants are dynamically typed; it is a hallucination. Like simple variants, polymorphic variants are type-checked statically.</p></div><div><p dir="auto">However, they are type-checked using different algorithms, which results in a different programming experience. The relationship between value and type (written with the colon symbol <code>:</code>) is changed with polymorphic variants. Usually, values are thought of as inhabitants of the type, which is regarded as a set-like thing. Rather, polymorphic variant values should be considered as pieces of data that several functions can accept. Polymorphic variants types are a way to express compatibility relationships between those functions. The approach in this tutorial is to build sense from experience using features of polymorphic variants.</p></div><div><p dir="auto"><strong>Prerequisites</strong>: This is an intermediate-level tutorial. It is required to have completed tutorials on <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/functions-and-values" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/functions-and-values" target="_blank">Functions and Values</a>, <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/basic-data-types" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/basic-data-types" target="_blank">Basic Data Types</a>, and <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/lists" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/lists" target="_blank">Lists</a> to begin this one.</p></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context)Origin and Context" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context)Origin_and_Context"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context" target="_blank"></a>Origin and Context</h3><div class="heading-children"><div><p dir="auto">Polymorphic variants originate from Jacques Garrigue's work on Objective Label, which was <a data-tooltip-position="top" aria-label="https://caml.inria.fr/pub/old_caml_site/caml-list-ar/0533.html" rel="noopener" class="external-link" href="https://caml.inria.fr/pub/old_caml_site/caml-list-ar/0533.html" target="_blank">first published in 1996</a>. It became part of standard Objective Caml with <a data-tooltip-position="top" aria-label="https://caml.inria.fr/distrib/ocaml-3.00/" rel="noopener" class="external-link" href="https://caml.inria.fr/distrib/ocaml-3.00/" target="_blank">release 3.0</a> in 2000, along with labelled and optional function arguments. They were introduced to give more precise types in <a data-tooltip-position="top" aria-label="https://garrigue.github.io/labltk/" rel="noopener" class="external-link" href="https://garrigue.github.io/labltk/" target="_blank">LablTk</a>.</p></div><div><p dir="auto">The core type system of OCaml follows a <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Nominal_type_system" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Nominal_type_system" target="_blank"><em>nominal</em></a> discipline. Variants must be explicitly declared before being used. The typing discipline used for polymorphic variants and classes is different, as it is <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Structural_type_system" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Structural_type_system" target="_blank"><em>structural</em></a>.</p></div><div><p dir="auto">In the nominal approach of typing, types are first defined; later, when the type of an expression is inferred, three outcomes are possible:</p></div><div><ol>
<li data-line="0" dir="auto">If a matching type is found, it becomes the inferred type.</li>
<li data-line="1" dir="auto">If any type can be applied, a type parameter is created.</li>
<li data-line="2" dir="auto">If typing inconsistencies are found, an error is raised.</li>
</ol></div><div><p dir="auto">This is very similar to solving an equation in mathematics. Equations accept either zero, exactly one, several, or infinitely many numbers as solutions. Nominal type-checking finds that either zero, exactly one, or any type can be used in an expression.</p></div><div><p dir="auto">In the structural approach of typing, type definitions are optional, so they can be omitted. Type-checking an expression constructs a data structure that represents the types that are compatible with it. These data structures are displayed as type expressions sharing a resemblance with simple variants.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism)A Note on Simple Variants and Polymorphism" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism)A_Note_on_Simple_Variants_and_Polymorphism"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism" target="_blank"></a>A Note on Simple Variants and Polymorphism</h3><div class="heading-children"><div><p dir="auto">The type expression <code>'a list</code> does not designate a single type; it designates a family of types, basically all the types that can be created by substituting an actual type to type parameter <code>'a</code>. The type expressions <code>int list</code>, <code>bool option list</code>, or <code>(float -&gt; float) list list</code> are real types. They're actual members of the <em>type family</em> <code>'a list</code>. Types are intended to have inhabitants, type families don't.</p></div><div><p dir="auto">The identifiers <code>list</code>, <code>option</code>, and others are <em>type operators</em>. Just like functions, they take parameters. Although these parameters are not values, they are types. Their results aren't values but types, too.</p></div><div><p dir="auto">Simple variants are polymorphic, but not in the same sense as polymorphic variants.</p></div><div><ul>
<li data-line="0" dir="auto">Simple variants have <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Parametric_polymorphism" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Parametric_polymorphism" target="_blank">parametric polymorphism</a></li>
<li data-line="1" dir="auto">Polymorphic variants have a form of <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Structural_type_system" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Structural_type_system" target="_blank">structural polymorphism</a></li>
</ul></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#a-first-example)A First Example" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#a-first-example)A_First_Example"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#a-first-example" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#a-first-example" target="_blank"></a>A First Example</h2><div class="heading-children"><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching)Creating Polymorphic Variant Types From Pattern Matching" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching)Creating_Polymorphic_Variant_Types_From_Pattern_Matching"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching" target="_blank"></a>Creating Polymorphic Variant Types From Pattern Matching</h3><div class="heading-children"><div><p dir="auto">The visual signature of the polymorphic variants is the back quote. Pattern matching on them looks just the same as with simple variants, except for back quotes (and capitals, which are no longer required).</p></div><div><pre><code># let f = function `Broccoli -&gt; "Broccoli" | `Fruit name -&gt; name;;
val f : [&lt; `Broccoli | `Fruit of string ] -&gt; string = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Here <code>`Broccoli</code> and <code>`Fruit</code> play a role similar to the one played by the constructors <code>Broccoli</code> and <code>Fruit</code> in a variant declared as <code>type t = Broccoli | Fruit of string</code>. Except, and most importantly, that the definition doesn't need to be written. The tokens <code>`Broccoli</code> and <code>`Fruit</code> are called <em>tags</em> instead of constructors. A tag is defined by a name and a list of parameter types.</p></div><div><p dir="auto">The expression <code>[&lt; `Broccoli | `Fruit of string ]</code> plays the role of a type. However, it does not represent a single type, it represents three different types.</p></div><div><ul>
<li data-line="0" dir="auto">The type that only has <code>`Broccoli</code> as an inhabitant, its translation into a simple variant is <code>type t0 = Broccoli</code></li>
<li data-line="1" dir="auto">The type that only has <code>`Fruit</code> as an inhabitant, its translation into a simple variant is <code>type t1 = Fruit of string</code></li>
<li data-line="2" dir="auto">Type type that has both <code>`Broccoli</code> and <code>`Fruit</code> inhabitants, its translation into a simple variant is <code>type t2 = Broccoli | Fruit of string</code></li>
</ul></div><div><p dir="auto">Note each of the above translations into simple variants is correct. However, entering them as-is into the environment would lead to constructor shadowing (unless type annotation is used at pattern or expression level, see section on <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#Shared-Constructors" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#Shared-Constructors" target="_blank">Shared Constructors</a>).</p></div><div><p dir="auto">This also illustrates the other striking feature of polymorphic variants: values can be attached to several types. For instance, the tag <code>`Broccoli</code> inhabits <code>[ `Broccoli ]</code> and<code>[ `Broccoli | `Fruit of String ]</code>, but it also inhabits any type that contains it.</p></div><div><p dir="auto">What is displayed by the type-checker, for instance <code>[&lt; `Broccoli | `Fruit of string ]</code>, isn't a single type. It is a type expression that designates a constrained set of types. For instance, all the types that are defined by a group of tags containing either <code>`Broccoli</code> or <code>`Fruit of string</code> and nothing more. This is the meaning of the <code>&lt;</code> sign in this type expression. This is a bit similar to what happens with <code>'a list</code>, which isn't a single type either, but a type expression that designates the set of <code>list</code> types of something, i.e. the set of types where <code>'a</code> has been replaced by some other type. It is also meant to indicate that the exact types are subsets of the indicated ones (this will be explained in the section on <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#Subtyping-of-Polymorphic-Variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#Subtyping-of-Polymorphic-Variants" target="_blank">Subtyping</a>).</p></div><div><p dir="auto">This is the sense of the polymorphism of polymorphic variants. Polymorphic variants types are type expressions. The structural typing algorithm used for polymorphic variants creates type expressions that designate sets of types (here the three types above), which are defined by constraints on sets of tags (the inequality symbols). The polymorphism of polymorphic variants is different.</p></div><div><p dir="auto">In the rest of this tutorial, the following terminology is used:</p></div><div><ul>
<li data-line="0" dir="auto">“simple variants”: product types and variants such as <code>list</code>, <code>option</code></li>
<li data-line="1" dir="auto">polymorphic variant: type expressions displayed by the OCaml type-checker such as <code>[&lt; `Broccoli | `Fruit of string ]</code></li>
</ul></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing)Tag Sharing" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing)Tag_Sharing"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing" target="_blank"></a>Tag Sharing</h3><div class="heading-children"><div><p dir="auto">Here is another function using pattern matching on a polymorphic variant.</p></div><div><pre><code># let g = function `Edible name -&gt; name | `Broccoli -&gt; "Brassica oleracea";;
val g : [&lt; `Broccoli | `Edible of string ] -&gt; string = &lt;fun&gt;

# f `Broccoli;;
- : string = "Broccoli"

# g `Broccoli;;
- : string = "Brassica oleracea"
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Both <code>f</code> and <code>g</code> accept the <code>`Broccoli</code> tag as input because they both have code for it. They do not have the same domain because <code>f</code> also accepts <code>`Fruit of string</code> whilst <code>g</code> also accepts <code>`Edible of string</code>. The domains of <code>f</code> and <code>g</code> express this. The tag <code>`Broccoli</code> satisfies both the constraints of the domain of <code>f</code>: <code>[&lt; `Broccoli | `Fruit of string ]</code> and the constraints of the domain of <code>g</code>: <code>[&lt; `Broccoli | `Fruit of string ]</code>. That type is <code>[ `Broccoli ]</code>. The value defined by a tag belongs to several types, similarly, a tag accepting functions belongs to several types.</p></div><div><p dir="auto">Polymorphic variant tags are meant to be used as stand-alone values, wherever it makes sense. As long as used consistently, with a single implicit type per tag, the type checker will accept any combination of them in pattern-matching expressions.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking)Static Type-Checking" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking)Static_Type-Checking"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking" target="_blank"></a>Static Type-Checking</h3><div class="heading-children"><div><p dir="auto">Type-checking of polymorphic variants is static. No information on tag types is available at runtime.</p></div><div><pre><code># [ `Fruit "Banana"; `Fruit true ];;
Error: This expression has type bool but an expression was expected of type
         string
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">When a tag is used inconsistently, the type-checker raises an error.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints)Merging Constraints" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints)Merging_Constraints"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints" target="_blank"></a>Merging Constraints</h3><div class="heading-children"><div><p dir="auto">When building an expression from sub-expressions, the type-checker assembles types from sub-expressions to create the type of the whole expression. This is why the type discipline used for polymorphic variants is said to be structural, it follows the structure of the expressions.</p></div><div><pre><code># let brocco = `Broccoli;;

# let pepe = `Peperone;;

# [ brocco; pepe; brocco ];;
- : [&gt; `Broccoli | `Peperone ] list = [`Broccoli; `Peperone; `Broccoli]
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants)Exact, Closed and Open Variants" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants)Exact,_Closed_and_Open_Variants"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants" target="_blank"></a>Exact, Closed and Open Variants</h2><div class="heading-children"><div><p dir="auto">Polymorphic variant type expressions can have three forms:</p></div><div><ol>
<li data-line="0" dir="auto"><strong>Exact</strong>: <code>[ `Broccoli | `Gherkin | `Fruit of string ]</code><br>
This only designates the type inhabited by the values introduced by these tags.</li>
<li data-line="2" dir="auto"><strong>Closed</strong>: <code>[&lt; `Broccoli | `Gherkin | `Fruit of string ]</code><br>
This designates a set of exact types. Each exact type is inhabited by the values introduced by a subset of the tags from 1. For instance, there are 7 exact types as such:</li>
</ol></div><div><ul>
<li data-line="0" dir="auto"><code>[ `Broccoli ]</code></li>
<li data-line="1" dir="auto"><code>[ `Gherkin ]</code></li>
<li data-line="2" dir="auto"><code>[ `Fruit of string ]</code></li>
<li data-line="3" dir="auto"><code>[ `Broccoli | `Gherkin ]</code></li>
<li data-line="4" dir="auto"><code>[ `Broccoli | `Fruit of string ]</code></li>
<li data-line="5" dir="auto"><code>[ `Gherkin | `Fruit of string ]</code></li>
<li data-line="6" dir="auto"><code>[ `Broccoli | `Gherkin | `Fruit of string ]</code></li>
</ul></div><div><ol start="3">
<li data-line="0" dir="auto"><strong>Open</strong>: <code>[&gt; `Broccoli | `Gherkin | `Fruit of string ]</code><br>
This designates a set of exact types. Each exact type is inhabited by the values introduced by supersets of the tags from 1.</li>
</ol></div><div><p dir="auto"><strong>Note</strong>: This syntax works like if the set of natural numbers greater or equal than three was written <em>{ &gt; 3 }</em> and the set <em>{ 0, 1, 2, 3 }</em> was written <em>{ &lt; 3 }</em>.</p></div><div><p dir="auto"><strong>Tip</strong>: To distinguish closed and open type expressions, you can remember that the less-than sign <code>&lt;</code> is oriented the same way as a capital <code>C</code> letter, as in closed.</p></div><div><p dir="auto">An exact form is inferred by the type-checker when naming a type defined by a set of tags:</p></div><div><pre><code># type t = [ `Broccoli | `Gherkin | `Fruit of string ]
type t = [ `Broccoli | `Fruit of string | `Gherkin ]
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Exact variants correspond closely to simple variants.</p></div><div><p dir="auto">The closed form is introduced when performing pattern matching over an explicit set of tags</p></div><div><pre><code># let f = function
    | `Broccoli -&gt; "Broccoli"
    | `Gherkin -&gt; "Gherkin"
    | `Fruit Fruit -&gt; Fruit;;
val upcast : [&lt; `Broccoli | `Fruit of string | `Gherkin ] -&gt; string = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The function <code>f</code> can be used with any exact type that has these three tags or less. When applied to a type with fewer tags, branches associated with removed tags turn safely into dead code. The type is closed because the function can't accept more than what is listed.</p></div><div><p dir="auto">The open form can be introduced in two different ways.</p></div><div><p dir="auto">Open polymorphic variants appear when using a catch-all pattern, either the underscore <code>_</code> symbol or a name:</p></div><div><pre><code># let g = function
    | `Broccoli -&gt; "Broccoli"
    | `Gherkin -&gt; "Gherkin"
    | `Fruit Fruit -&gt; Fruit
    | _ -&gt; "Edible plant";;
val g : [&gt; `Broccoli | `Fruit of string | `Gherkin ] -&gt; string = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The function <code>g</code> can be used with any exact type that has these three tags or more. Because of the catch-all pattern, if <code>g</code> is passed a value introduced by a tag that is not part of the list, it will be accepted, and <code>"Edible plant"</code> is returned. The type is open because it can accept more than what is listed in its expression.</p></div><div><p dir="auto"><strong>Note</strong>: The type of <code>g</code> is also meant to disallow exact types with tags removed or changed in type. OCaml is a statically typed language, which means no type information is available at runtime. As a consequence pattern matching only relies on tag names. If <code>g</code> was assigned to a type with removed tags, such as <code>[&gt; `Broccoli | `Gherkin ]</code>, then passing <code>`Fruit</code> to <code>g</code> would be allowed, but since dispatch is based on names, it would execute the <code>`Fruit of string</code> branch and crash because no string is available. Therefore, an open polymorphic variant must include all the tags from pattern matching.</p></div><div><p dir="auto">Open polymorphic variants also appear when type-checking tags as values.</p></div><div><pre><code># `Gherkin
- : [&gt; `Gherkin ] = `Gherkin

# [ `Broccoli; `Gherkin; `Broccoli ];;
- : [&gt; `Broccoli | `Gherkin ] list = [ `Broccoli; `Gherkin; `Broccoli ]
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Setting the type of tag to the open polymorphic variant which only contains it enables:</p></div><div><ul>
<li data-line="0" dir="auto">To use it in all the contexts where applicable code is available.</li>
<li data-line="1" dir="auto">To avoid using it in contexts that can't deal with it.</li>
<li data-line="2" dir="auto">The build of sums of polymorphic variants. This is shown in the second example.</li>
</ul></div><div><p dir="auto">This also applies to functions returning polymorphic variant values.</p></div><div><pre><code># let f b = if b then `Up else `Down;;
val f : bool -&gt; [&gt; `Down | `Up ] = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The codomain of <code>f</code> is the open type <code>[&gt; `Down | `Up ]</code>. This makes sense when having a look at function composition.</p></div><div><pre><code># let g = function
    | `Up -&gt; 1
    | `Down -&gt; 2
    | `Broken -&gt; 3;;

# fun x -&gt; x |&gt; f |&gt; g;;
- : bool -&gt; int = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Functions <code>g</code> and <code>f</code> can be composed because <code>g</code> accepts more than what <code>f</code> can return. The value <code>`Broken</code> will never pass from <code>f</code> into <code>g</code>, but it is safe to write it as no unexpected value can make its way through.</p></div><div><p dir="auto">Closed and open cases are polymorphic because they do not designate a single type but families of types. An exact variant type is (structurally) monomorphic, it corresponds to a single variant type, not a set of variant types.</p></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant)Both Open and Closed Polymorphic Variant" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant)Both_Open_and_Closed_Polymorphic_Variant"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant" target="_blank"></a>Both Open and Closed Polymorphic Variant</h3><div class="heading-children"><div><p dir="auto">A closed variant type may also have an additional constraint preventing some tags from being removed.</p></div><div><pre><code># let is_red = function `Clubs -&gt; false | `Diamonds -&gt; true | `Hearts -&gt; true | `Spades -&gt; false;;
val is_red : [&lt; `Clubs | `Diamonds | `Hearts | `Spades ] -&gt; bool = &lt;fun&gt;

# let h = fun u -&gt; List.map is_red (`Hearts :: u);;
val h : [&lt; `Clubs | `Diamonds | `Hearts | `Spades &gt; `Hearts ] list -&gt; bool list = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Function <code>is_red</code> accepts values from any subtype of <code>[ `Clubs | `Diamonds | `Hearts | `Spades ]</code>. However, function <code>h</code> excludes the exact types <code>[ `Clubs ]</code>, <code>[ `Diamonds ]</code> and <code>[ `Spades ]</code>. The list passed to <code>List.map</code> includes a <code>`Hearts</code> tag. Types that do not include it are not allowed.</p></div><div><p dir="auto">The domain of <code>h</code> is:</p></div><div><ul>
<li data-line="0" dir="auto">closed by <code>[ `Clubs | `Diamonds | `Hearts | `Spades ]</code> and,</li>
<li data-line="1" dir="auto">open by <code>[ `Hearts ]</code>.</li>
</ul></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants)Subtyping of Polymorphic Variants" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants)Subtyping_of_Polymorphic_Variants"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants" target="_blank"></a>Subtyping of Polymorphic Variants</h2><div class="heading-children"><div><p dir="auto">Simple variants have a form of polymorphism called <em>parametric polymorphism</em>. Together with predefined types, they are type-checked using the nominal typing discipline. In this discipline, a value has a unique type.</p></div><div><p dir="auto">In the structural type-checking discipline used for polymorphic variants, a value may have several types. Equivalently it can be said to inhabit several types:</p></div><div><pre><code># let gherkin = `Gherkin;;
val Gherkin : [&gt; `Gherkin ] = `Gherkin

# let (gherkin : [ `Gherkin ]) = `Gherkin;;
val Gherkin : [ `Gherkin ] = `Gherkin

# let (gherkin : [ `Gherkin | `Avocado ]) = `Gherkin;;
val Gherkin : [ `Gherkin | `Avocado ] = `Gherkin
</code><button class="copy-code-button">Copy</button></pre></div><div><ol>
<li data-line="0" dir="auto">By default, the type assigned to the <code>`Gherkin</code> tag is <code>[&gt; `Gherkin]</code>. It means any variant type that includes that tag.</li>
<li data-line="1" dir="auto">Using an annotation, the type can be restrained to <code>[ `Gherkin ]</code>, the exact variant type only containing <code>`Gherkin</code></li>
<li data-line="2" dir="auto">Using another annotation allows assigning the <code>`Gherkin</code> value to a type containing more tags.</li>
</ol></div><div><p dir="auto">This entails a partial ordering relation between exact variant types. The type <code>[ `Gherkin ]</code> is smaller than the type <code>[ `Gherkin | `Avocado ]</code>. The types <code>`[ `Gherkin ]</code> and <code>[ `Avocado ]</code> do not compare. The type <code>`[ `Gherkin ]</code> is the smallest possible type for the tag <code>`Gherkin</code>.</p></div><div><p dir="auto">The order between the exact variants derives from the <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Partially_ordered_set#Partial_order" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Partially_ordered_set#Partial_order" target="_blank">partial order</a> on <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Subset" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Subset" target="_blank">subsets</a> of tags. The sets considered are the tags, with names and types. This order is said to be partial because some sets can't be compared. This order is called the <em>subtyping</em> order.</p></div><div><p dir="auto">The OCaml syntax does not allow expression of the <a data-tooltip-position="top" aria-label="https://github.com/ocaml/ocaml/issues/10687" rel="noopener" class="external-link" href="https://github.com/ocaml/ocaml/issues/10687" target="_blank">empty</a> polymorphic variant type. If it was, it would be the least element in the subtyping order.</p></div><div><p dir="auto">OCaml has a cast operator, it allows to raise the type of an expression into any larger type, with respect to the subtyping order. It is written <code>:&gt;</code></p></div><div><pre><code># (gherkin :&gt; [ `Avocado | `Gherkin | `Tomato ]);;
- : [ `Avocado | `Gherkin | `Tomato ] = `Gherkin
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">It means the type of <code>gherkin</code> is raised from <code>[ `Gherkin | `Tomato ]</code> into <code>[ `Avocado | `Gherkin | `Tomato ]</code>. It is admissible because <code>[ `Gherkin | `Tomato ]</code> is smaller than <code>[ `Avocado | `Gherkin | `Tomato ]</code> in the subtyping order.</p></div><div><p dir="auto">When casting, it is also possible to indicate the subtype from which the value is upcast.</p></div><div><pre><code># (gherkin : [ `Gherkin | `Tomato ] :&gt; [ `Avocado | `Gherkin | `Tomato ]);;
- : [ `Avocado | `Gherkin | `Tomato ] = `Gherkin
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types)Named Polymorphic Variant Types" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types)Named_Polymorphic_Variant_Types"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types" target="_blank"></a>Named Polymorphic Variant Types</h2><div class="heading-children"><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#naming)Naming" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#naming)Naming"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#naming" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#naming" target="_blank"></a>Naming</h3><div class="heading-children"><div><p dir="auto">Exact polymorphic variant types can be given names.</p></div><div><pre><code># type exotic = [ `Guayaba | `Maracuya | `Papaya ];;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Named polymorphic variants are always exact, thus they are equivalent to simple variants. It is not possible to give names to closed or open polymorphic variants.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#type-extension)Type extension" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#type-extension)Type_extension"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#type-extension" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#type-extension" target="_blank"></a>Type extension</h3><div class="heading-children"><div><p dir="auto">Named polymorphic variants can be used to create extended types.</p></div><div><pre><code># type mexican = [ exotic | `Pitahaya | `Sapodilla ];;
type mexican = [ `Guayaba | `Maracuya | `Papaya | `Pitahaya | `Sapodilla ]
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns)Hash Patterns" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns)Hash_Patterns"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns" target="_blank"></a>Hash Patterns</h3><div class="heading-children"><div><p dir="auto">Named polymorphic variants can be used as patterns.</p></div><div><pre><code># let f = function
    | #exotic -&gt; "Exotic Fruit"
    | `Mango -&gt; "Mango";;
val f : [&lt; `Guayaba | `Mango | `Maracuya | `Papaya ] -&gt; string = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">This is not a dynamic type check. The <code>#exotic</code> pattern acts like a macro, it is a shortcut to avoid writing all the corresponding patterns.</p></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants)Advanced: Aliased, Parametrized and Recursive Polymorphic Variants" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants)Advanced:_Aliased,_Parametrized_and_Recursive_Polymorphic_Variants"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants" target="_blank"></a>Advanced: Aliased, Parametrized and Recursive Polymorphic Variants</h2><div class="heading-children"><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases)Inferred Type Aliases" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases)Inferred_Type_Aliases"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases" target="_blank"></a>Inferred Type Aliases</h3><div class="heading-children"><div><pre><code># function `Avocado -&gt; `Cilantro | plant -&gt; plant;;
- : ([&gt; `Cilantro | `Avocado ] as 'a) -&gt; 'a = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The meaning of the type of this function is twofold.</p></div><div><ol>
<li data-line="0" dir="auto">Any exact variant type which is a super set of <code>[&gt; `Cilantro | `Avocado ]</code> is a domain</li>
<li data-line="1" dir="auto">The very same type is also a codomain</li>
</ol></div><div><p dir="auto">The meaning of <code>'a</code> is not the same as with simple variants. It is not a type parameter meant to be replaced by another type. The <code>as 'a</code> part in the type expression <code>[&gt; `Cilantro | `Avocado ] as 'a</code> means <code>[&gt; `Cilantro | `Avocado ]</code> is bound to the local name <code>'a</code> in the overall expression. It allows expressing that the same variant type is used as both domain and codomain. This is a consequence of the <code>plant -&gt; plant</code> clause that forces domain and codomain types to be the same.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants)Parametrized Polymorphic Variants" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants)Parametrized_Polymorphic_Variants"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants" target="_blank"></a>Parametrized Polymorphic Variants</h3><div class="heading-children"><div><p dir="auto">It is possible to combine polymorphic variants and parametric polymorphism. Here is a duplication of the <code>'a option</code> type, translated as a polymorphic variant parametrized with a type parameter.</p></div><div><pre><code># let map f = function
    | `Some x -&gt; `Some (f x)
    | `None -&gt; `None;;
val map : ('a -&gt; 'b) -&gt; [&lt; `None | `Some of 'a ] -&gt; [&gt; `None | `Some of 'b ] =
  &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">This <code>map</code> function has two type parameters: <code>'a</code> and <code>'b</code>. They are used to type its <code>f</code> parameter.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants)Recursive Polymorphic Variants" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants)Recursive_Polymorphic_Variants"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants" target="_blank"></a>Recursive Polymorphic Variants</h3><div class="heading-children"><div><p dir="auto">The inferred type of a polymorphic variant may be recursive.</p></div><div><pre><code># let rec map f = function
    | `Nil -&gt; `Nil
    | `Cons (x, u) -&gt; `Cons (f x, map f u);;
val map :
  ('a -&gt; 'b) -&gt;
  ([&lt; `Cons of 'a * 'c | `Nil ] as 'c) -&gt; ([&gt; `Cons of 'b * 'd | `Nil ] as 'd) =
  &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The aliasing mechanism is used to express type recursion. In the type expression <code>[&lt; `Cons of 'a * 'c | `Nil ] as 'c</code>, the local name <code>'c</code> occurs inside the defined thing: <code>[&lt; `Cons of 'a * 'c | `Nil ]</code>. Therefore, it is a recursive type definition.</p></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants)Advanced: Combined Subtyping of Polymorphic and Simple Variants" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants)Advanced:_Combined_Subtyping_of_Polymorphic_and_Simple_Variants"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants" target="_blank"></a>Advanced: Combined Subtyping of Polymorphic and Simple Variants</h2><div class="heading-children"><div><p dir="auto">A tag <code>`Night</code> inhabits any type with additional tags, for instance <code>[ `Night | `Day ]</code> or <code>[`Morning | `Afternoon | `Evening | `Night]</code>. This is summarized by the subtyping order where <code>[ `Night ]</code> is smaller to both <code>[ `Night | `Day ]</code> and <code>[`Morning | `Afternoon | `Evening | `Night ]</code>.</p></div><div><p dir="auto">This can be seen by defining a function <code>upcast</code> in the following way:</p></div><div><pre><code># let upcast (x : [ `Night ]) = (x :&gt; [ `Night | `Day ]);;
val upcast : [ `Night ] -&gt; [ `Night | `Day ] = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">This function is an identity function it returns its parameter unchanged. It illustrates a value of type <code>[ `Night ]</code> can be cast into the type <code>[ `Night | `Day ]</code>. Casting goes from subtype to supertype.</p></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant)Predefined Simple Variants are Covariant" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant)Predefined_Simple_Variants_are_Covariant"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant" target="_blank"></a>Predefined Simple Variants are Covariant</h3><div class="heading-children"><div><p dir="auto">The subtyping order extends to simple variants. Functions <code>upcast_opt</code> <code>upcast_list</code> and <code>upcast_snd</code> are doing the same thing as <code>upcast</code> except they are taking parameters from variants parametrized by polymorphic variants.</p></div><div><pre><code># let upcast_opt (x : [ `Night ] option) = (x :&gt; [ `Night | `Day ] option);;
val upcast_opt : [ `Night ] option -&gt; [ `Night | `Day ] option = &lt;fun&gt;

# let upcast_list (x : [ `Night ] list) = (x :&gt; [ `Night | `Day ] list);;
val upcast_list : [ `Night ] list -&gt; [ `Night | `Day ] list = &lt;fun&gt;

let upcast_snd (x : [ `Night ] * int) = (x :&gt; [ `Night | `Day ] * int);;
val upcast_snd : [ `Night ] * int -&gt; [ `Night | `Day ] * int = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The product type and the types <code>option</code>, <code>list</code> are said to be <em>covariant</em>. Subtyping on parametrized variants goes “in the same direction” as on polymorphic variants parameters:</p></div><div><ul>
<li data-line="0" dir="auto"><code>[ `Night ]</code> is a subtype of <code>[ `Night | `Day ]</code></li>
<li data-line="1" dir="auto"><code>[ `Night ] list</code> is a subtype of <code>[ `Night | `Day ] list</code></li>
</ul></div><div><p dir="auto">Note that these types are covariant because of the way their type parameters appear in the type of their constructors. This is detailed in <a data-tooltip-position="top" aria-label="https://v2.ocaml.org/manual/typedecl.html#ss:typedefs" rel="noopener" class="external-link" href="https://v2.ocaml.org/manual/typedecl.html#ss:typedefs" target="_blank">Chapter 11, Section 8.1</a> of the OCaml Manual. This has nothing to do with being predefined types.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant)Function Codomains are Covariant" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant)Function_Codomains_are_Covariant"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant" target="_blank"></a>Function Codomains are Covariant</h3><div class="heading-children"><div><p dir="auto">The function type is covariant on codomains. Casting a function is allowed if the target codomain is larger.</p></div><div><pre><code># let upcast_dom (f : int -&gt; [ `Night ]) = (x :&gt; int -&gt; [ `Night | `Day ]);;
val f : (int -&gt; [ `Night ]) -&gt; int -&gt; [ `Night | `Day ] = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Covariance means subtyping “goes in the same direction”:</p></div><div><ul>
<li data-line="0" dir="auto">On codomain: <code>[ `Night ]</code> is a subtype of <code>[ `Night | `Day ]</code></li>
<li data-line="1" dir="auto">On function type: <code>int -&gt; [ `Night ]</code> is a subtype of <code>int -&gt; [ `Night | `Day ]</code></li>
</ul></div><div><p dir="auto">Adding tags to a polymorphic variant codomain of a function is harmless. Extending a function's codomain is pretending it can return something that is never returned. It is a false promise, and the precision of the type is reduced, but it is safe, no unexpected data will ever be returned by the function.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant)Function Domains are Contravariant" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant)Function_Domains_are_Contravariant"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant" target="_blank"></a>Function Domains are Contravariant</h3><div class="heading-children"><div><p dir="auto">The function type is <em>contravariant</em> on domains. Casting a function is allowed if the target domain is smaller.</p></div><div><pre><code># let upcast_cod (f : [ `Night | `Day ] -&gt; int) = (x :&gt; [ `Night ] -&gt; int);;
val f : ([ `Night | `Day ] -&gt; int) -&gt; [ `Night ] -&gt; int = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Contravariance means subtyping “is reversed”:</p></div><div><ul>
<li data-line="0" dir="auto">On domain: <code>[ `Night ]</code> is a subtype of <code>[ `Night | `Day ]</code></li>
<li data-line="1" dir="auto">On function type: <code>[ `Night | `Day ] -&gt; int</code> is a subtype of <code>[ `Night ] -&gt; int</code></li>
</ul></div><div><p dir="auto">At first, it may seem counterintuitive. However, removing tags from a polymorphic variant domain is also harmless. The code in charge of the removed tags is turned into dead paths. Implemented generality of the function is lost, but it is safe, no data will be passed that the function can't handle.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work)Covariance and Contravariance at Work" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work)Covariance_and_Contravariance_at_Work"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work" target="_blank"></a>Covariance and Contravariance at Work</h3><div class="heading-children"><div><pre><code># let ingredient = function 0 -&gt; `Flour | _ -&gt; `Masa;;
val ingredient : int -&gt; [&gt; `Masa | `Flour ] = &lt;fun&gt;

# let chef = function
    | `Flour -&gt; `Bread
    | `Egg -&gt; `Tortilla
    | `Masa -&gt; `Tortilla;;
val chef : [&lt; `Masa | `Flour | `Egg ] -&gt; [&gt; `Bread | `Tortilla ] =
  &lt;fun&gt;

# let taste = function `Tortilla | `Bread -&gt; "Nutritious" | `Cake -&gt; "Yummy";;
val taste : [&lt; `Bread | `Tortilla | `Cake ] -&gt; string = &lt;fun&gt;

# fun n -&gt; n |&gt; ingredient |&gt; chef |&gt; taste;;
- : int -&gt; string = &lt;fun&gt;

# let upcasted_chef =
    (chef :&gt; [&lt; `Flour | `Masa ] -&gt; [&gt; `Bread | `Tortilla | `Cake ]);;
val upcasted_chef : [&lt; `Flour | `Masa ] -&gt; [&gt; `Bread | `Tortilla | `Cake ] =
  &lt;fun&gt;

# fun n -&gt; n |&gt; ingredient |&gt; upcasted_chef |&gt; taste;;
- : int -&gt; string = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The type of <code>chef</code> is a subtype of the type of <code>upcasted_chef</code>. The function <code>upcasted_chef</code> has a reduced domain and enlarged codomain. However, <code>upcasted_chef</code> has a domain that remains larger than the codomain of <code>ingredient</code> and, a codomain that remains smaller than the domain of <code>taste</code>. Therefore, it is safely possible to consider <code>chef</code> as an inhabitant of the type of <code>upcasted_chef</code> in the composition pipe where it is used.</p></div><div><p dir="auto">It is also possible to refactor <code>chef</code> into a new function that can be used safely at the same place.</p></div><div><pre><code># let refactored_chef = function
    | `Flour -&gt; `Bread
    | `Masa -&gt; (`Tortilla : [&gt; `Bread | `Tortilla | `Cake ]);;

# fun n -&gt; n |&gt; ingredient |&gt; refactored_chef |&gt; taste;;
- : int -&gt; string = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#uses-cases)Uses-Cases" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#uses-cases)Uses-Cases"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#uses-cases" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#uses-cases" target="_blank"></a>Uses-Cases</h2><div class="heading-children"><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration)Variants Without Declaration" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration)Variants_Without_Declaration"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration" target="_blank"></a>Variants Without Declaration</h3><div class="heading-children"><div><p dir="auto">Not having to explicitly declare polymorphic variant types is beneficial in several cases.</p></div><div><ul>
<li data-line="0" dir="auto">When few functions use the type</li>
<li data-line="1" dir="auto">When many types would have to be declared</li>
</ul></div><div><p dir="auto">When reading a pattern-matching expression using polymorphic variant tags, understanding is local. Since polymorphic variant types are anonymous or aliases, there is no need to search for the meaning of the tags somewhere else. The meaning arises from the expression itself.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors)Shared Constructors" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors)Shared_Constructors"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors" target="_blank"></a>Shared Constructors</h3><div class="heading-children"><div><p dir="auto">When several simple variants use the same constructor name, shadowing takes place. To pattern match over a shadowed variant, type annotation must be added, either to the whole pattern-matching expression or to some patterns.</p></div><div><pre><code># type a = A;;
type a = A
# type b = A;;
type b = A
# function A -&gt; true;;
- : b -&gt; bool = &lt;fun&gt;
# function (A : a) -&gt; true;;
- : a -&gt; bool = &lt;fun&gt;
# (function A -&gt; true : a -&gt; bool);;
- : a -&gt; bool = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Without this, previously entered ones are no longer reachable. This can be worked around using modules. This is explained in <a data-tooltip-position="top" aria-label="https://dev.realworldocaml.org/records.html#scrollNav-3" rel="noopener" class="external-link" href="https://dev.realworldocaml.org/records.html#scrollNav-3" target="_blank">Reusing Field Names</a> ) of the <em>Real World OCaml</em> book written by Yaron Minsky and Anil Madhavapeddy.</p></div><div><p dir="auto">This problem never happens with polymorphic variants. When a tag appears several times in an expression, it must be with the same type, that's the only restriction. This makes polymorphic variants very handy when dealing with multiple sum types sharing constructors.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules)Data Type Sharing Between Modules" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules)Data_Type_Sharing_Between_Modules"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules" target="_blank"></a>Data Type Sharing Between Modules</h3><div class="heading-children"><div><p dir="auto">Using the same type in two different modules can be done in several ways:</p></div><div><ul>
<li data-line="0" dir="auto">Having a dependency, either direct or shared</li>
<li data-line="1" dir="auto">Turn the dependent module into a functor and inject the dependence as a parameter</li>
</ul></div><div><p dir="auto">The polymorphic variants provide an additional alternative. This was proposed by Jacques Garrigue in his seminal paper “Programming with Polymorphic Variants” (ACM SIGPLAN Workshop on ML, October 1998):</p></div><div><blockquote dir="auto">
<p>You [...] define the same [polymorphic variant] type in both [modules], and since these are only type abbreviations, the two definitions are compatible. The type system checks the structural equality when you pass a value from one [module] to the other.</p>
</blockquote></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type)Error Handling Using the `result` Type" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type)Error_Handling_Using_the_`result`_Type"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type" target="_blank"></a>Error Handling Using the <code>result</code> Type</h3><div class="heading-children"><div><p dir="auto">The <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/error-handling" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/error-handling" target="_blank">Error Handling</a> guide details possible ways to handle errors in OCaml. Among various mechanisms, the <code>result</code> type, when used as a monad, provides a powerful means to handle errors. Refer to the guide and documentation on this type to learn how to use it. In this section, we discuss why using polymorphic variants to carry error values can be beneficial.</p></div><div><p dir="auto">Let's consider this exception-raising code:</p></div><div><pre><code># let f_exn m n =
    let open List in
    let u = init m Fun.id |&gt; map (fun n -&gt; n * n) in
    nth u n;;
val f_exn : int -&gt; int -&gt; int = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The following is an attempt at translating <code>f_exn</code> with <code>result</code> values instead of exceptions. It is using the <code>Result.bind</code> instead of <code>|&gt;</code>:</p></div><div><pre><code># type init_error = Negative_length;;

# let init n f = try Ok (List.init n f) with
    | Invalid_argument _ -&gt; Error Negative_length;;
val init : int -&gt; (int -&gt; 'a) -&gt; ('a list, init_error) result = &lt;fun&gt;

# type nth_error = Too_short of int * int | Negative_index of int;;
type nth_error = Too_short of int * int | Negative_index of int

# let nth u i = try Ok (List.nth u i) with
    | Invalid_argument _ -&gt; Error (Negative_index i)
    | Failure _ -&gt; Error (Too_short (List.length u, i))
val nth : 'a list -&gt; int -&gt; ('a, nth_error) result = &lt;fun&gt;

# let f_res m n =
    let* u = init m Fun.id in
    let u = List.map (fun n -&gt; n * n) u in
    let* x = nth u n in
    Ok x;;
Error: This expression has type (int, nth_error) result
       but an expression was expected of type (int, init_error) result
       Type nth_error is not compatible with type init_error
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">This does not work because of the type of <code>Result.bind</code>.</p></div><div><pre><code># Result.bind;;
- : ('a, 'e) result -&gt; ('a -&gt; ('b, 'e) result) -&gt; ('b, 'e) result = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Binding can't change the <code>'e</code> type, while this code needs it to change throughout the pipe.</p></div><div><p dir="auto">Here is an equivalent version using polymorphic variants:</p></div><div><pre><code># let ( let* ) = Result.bind;;
val ( let* ) : ('a, 'b) result -&gt; ('a -&gt; ('c, 'b) result) -&gt; ('c, 'b) result =
  &lt;fun&gt;

# let init n f = try Ok (List.init n f) with
    | Invalid_argument _ -&gt; Error `Negative_length;;
val init : int -&gt; (int -&gt; 'a) -&gt; ('a list, [&gt; `Negative_length ]) result =

# let nth u i = try Ok (List.nth u i) with
    | Invalid_argument _ -&gt; Error (`Negative_index i)
    | Failure _ -&gt; Error (`Too_short (List.length u, i));;
val nth :
  'a list -&gt;
  int -&gt; ('a, [&gt; `Negative_index of int | `Too_short of int * int ]) result =
  &lt;fun&gt;

# let f_res m n =
    let* u = init m Fun.id in
    let u = List.map (fun n -&gt; n * n) u in
    let* x = nth u n in
    Ok x;;
val f_res :
  int -&gt;
  int -&gt;
  (int,
   [&gt; `Negative_index of int | `Negative_length | `Too_short of int * int ])
  result = &lt;fun&gt;

</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Using polymorphic variants, the type-checker generates a unique type for the whole pipe. The constraints coming from calling <code>init</code> and <code>nth_error</code> are merged into a single type.</p></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#drawbacks)Drawbacks" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#drawbacks)Drawbacks"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#drawbacks" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#drawbacks" target="_blank"></a>Drawbacks</h2><div class="heading-children"><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions)Hard-to-Read Type Expressions" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions)Hard-to-Read_Type_Expressions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions" target="_blank"></a>Hard-to-Read Type Expressions</h3><div class="heading-children"><div><p dir="auto">By default, polymorphic variant types aren't declared with a name before being used. The compiler will generate type expressions corresponding to each function dealing with polymorphic variants. Some of those types are hard to read. When several such functions are composed together, inferred types can become very large and difficult to understand.</p></div><div><pre><code># let rec fold_left f y = function `Nil -&gt; y | `Cons (x, u) -&gt; fold_left f (f x y) u;;
val fold_left :
  ('a -&gt; 'b -&gt; 'b) -&gt; 'b -&gt; ([&lt; `Cons of 'a * 'c | `Nil ] as 'c) -&gt; 'b = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types)Over Constrained Types" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types)Over_Constrained_Types"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types" target="_blank"></a>Over Constrained Types</h3><div class="heading-children"><div><p dir="auto">In some circumstances, combining sets of constraints will artificially reduce the domain of a function. This happens when the conjunction of constraints must be taken. Functions <code>f</code> and <code>g</code> used here are those defined in the <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#a-first-example" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#a-first-example" target="_blank">first section</a>.</p></div><div><pre><code># f;;
- : [&lt; `Broccoli | `Fruit of string ] -&gt; string = &lt;fun&gt;

# g;;
- : [&lt; `Broccoli | `Edible of string ] -&gt; string = &lt;fun&gt;

# let u = [f; g];;
u : ([&lt; `Broccoli ] -&gt; string) list = [&lt;fun&gt;; &lt;fun&gt;]

# f (`Fruit "Pitahaya");;
- : string = "Pitahaya"

# (List.hd u) (`Fruit "Pitahaya");;
Error: This expression has type [&gt; `Fruit of string ]
       but an expression was expected of type [&lt; `Broccoli ]
       The second variant type does not allow tag(s) `Fruit
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Function <code>f</code> accepts tags <code>`Broccoli</code> and <code>`Fruit</code> whilst <code>g</code> accepts <code>`Broccoli</code> and <code>`Edible</code>. But if <code>f</code> and <code>g</code> are stored in a list, they must have the same type. That forces their domain to be restricted to a common subtype. Although <code>f</code> can handle the tag <code>`Fruit</code>, it no longer accepts that parameter when <code>f</code> is extracted from the list.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging)Weaken Type-Checking and Harder Debugging" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging)Weaken_Type-Checking_and_Harder_Debugging"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging" target="_blank"></a>Weaken Type-Checking and Harder Debugging</h3><div class="heading-children"><div><p dir="auto">This is adapted from the section <a data-tooltip-position="top" aria-label="https://dev.realworldocaml.org/variants.html#scrollNav-4-2" rel="noopener" class="external-link" href="https://dev.realworldocaml.org/variants.html#scrollNav-4-2" target="_blank">Example: Terminal Colors Redux</a> from the “Real World OCaml” book.</p></div><div><p dir="auto">Tags are used to store color representations:</p></div><div><ul>
<li data-line="0" dir="auto"><code>`RGB</code> contains a <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/RGB_color_model" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/RGB_color_model" target="_blank">red, green and blue</a> triplet</li>
<li data-line="1" dir="auto"><code>`Gray</code> contains a <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Grayscale" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Grayscale" target="_blank">grayscale</a> value</li>
<li data-line="2" dir="auto"><code>`RGBA</code> contains a <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/RGBA_color_model" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/RGBA_color_model" target="_blank">red, green, blue, alpha</a> quadruplet</li>
</ul></div><div><p dir="auto">The polymorphic variant type <code>color</code> groups the tags <code>`RGB</code> and <code>`Gray</code> whilst the type <code>extended_color</code> has three tags by extending <code>color</code> with <code>`RGBA</code>. Functions are defined to convert colors into integers.</p></div><div><pre><code># type color = [ `Gray of int | `RGB of int * int * int ];;
type color = [ `Gray of int | `RGB of int * int * int ]

# type extended_color = [ color | `RGBA of int * int * int * int ];;
type extended_color =
    [ `Gray of int | `RGB of int * int * int | `RGBA of int * int * int * int ]

# let color_to_int = function
  | `RGB (r, g, b) -&gt; 36 * r + 6 * g + b + 16
  | `Gray i -&gt; i + 232;;
val color_to_int : [&lt; `Gray of int | `RGB of int * int * int ] -&gt; int = &lt;fun&gt;

# let extended_color_to_int = function
  | `RGBA (r, g, b, a) -&gt; 216 * r + 36 * g + 6 * b + a + 16
  | `Grey i -&gt; i + 2000
  | #color as color -&gt; color_to_int color;;
val extended_color_to_int :
  [&lt; `Gray of int
   | `Grey of int
   | `RGB of int * int * int
   | `RGBA of int * int * int * int ] -&gt;
  int = &lt;fun&gt;

</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The function <code>color_to_int</code> can convert <code>`RGB</code> or <code>`Gray</code> values. The function <code>extended_color_to_int</code> is intended to convert <code>`RGB</code>, <code>`Gray</code> or <code>`RGBA</code> values; but it is supposed to apply a different conversion formula for gray scales. However, a typo was made, it is spelled <code>`Gray</code>. The type-checker accepts this definition of <code>extended_color_to_int</code> as a function accepting four tags.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="[](https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type)Over Approximating Type" dir="auto" class="heading" id="[](https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type)Over_Approximating_Type"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type" target="_blank"></a>Over Approximating Type</h3><div class="heading-children"><div><p dir="auto">The following function was presented in the <a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#Inferred-Type-Aliases" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#Inferred-Type-Aliases" target="_blank">Inferred Type Aliases</a> section.</p></div><div><pre><code># function `Avocado -&gt; `Cilantro | plant -&gt; plant;;
- : ([&gt; `Cilantro | `Avocado ] as 'a) -&gt; 'a = &lt;fun&gt;
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Because of the <code>plant -&gt; plant</code> pattern, the types inferred as domain and codomain are the same. As <code>`Avocado</code> is accepted, it must be part of the domain; and as <code>`Cilantro</code> is returned, it must be part of the codomain. Both end up being part of the common type. However, <code>`Avocado</code> should not be part of the codomain, as this function can't possibly return this value. A finer type-checker would infer more precise types. Type-checking is an approximation and a trade-off, some valid programs are rejected, and some types are too coarse.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Performances" dir="auto" class="heading" id="Performances"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Performances</h3><div class="heading-children"><div><p dir="auto">TODO: Expand this section</p></div><div><blockquote dir="auto">
<p>There is one more downside: the runtime cost. A value <code>Pair (x, y)</code> occupies 3 words in memory, while a value <code>`Pair (x, y)</code> occupies 6 words.</p>
</blockquote></div><div><p dir="auto">Guillaume Melquiond</p></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="When to Use Polymorphic Variant" dir="auto" class="heading" id="When_to_Use_Polymorphic_Variant"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>When to Use Polymorphic Variant</h2><div class="heading-children"><div><p dir="auto">Only using polymorphic variants is over-engineering, it should be avoided. Polymorphic variants aren't an extension of simple variants. From the data perspective, polymorphic variants and simple variants are equivalent. They both are sum types in the algebraic data types sense, both with parametric polymorphism and recursion. Back quote isn't a difference that matters. The only meaningful difference is the algorithm. Therefore, deciding when to use polymorphic variants boils down to another question:</p></div><div><blockquote dir="auto">
<p>Are nominally or structurally type-checked variants needed?</p>
</blockquote></div><div><p dir="auto">Answering this isn't significantly easier, but it helps to narrow what to consider. The key difference lies in the way pattern matching is type-checked. Polymorphic variant induces functions that intrinsically accept more data than simple variants. This is a consequence of the subtyping relation between polymorphic variant types.</p></div><div><p dir="auto">In a precautionary approach (inspired by <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/KISS_principle" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/KISS_principle" target="_blank">KISS</a> or <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it" rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it" target="_blank">YAGNI</a> design principles), using simple variants should be the default. However, they can feel too tight. Here are clues indicating this:</p></div><div><ul>
<li data-line="0" dir="auto">Many variant declarations look alike</li>
<li data-line="1" dir="auto">Equivalent constructor duplicated in several variants</li>
<li data-line="2" dir="auto">Variant declared for a single-purpose</li>
<li data-line="3" dir="auto">Variant declaration feeling made up or artificial</li>
</ul></div><div><p dir="auto">Having difficulties finding names for simple variants or constructors may be smell for one of the above. When such discomfort is felt, polymorphic variants may not be the solution, but they can be considered. Keep in mind they may ease some parts but at the expense of understandability, precision and performance. Hopefully, very soon, LLM bots will be able to refactor variants of some sort into the other. This will ease experimentation.</p></div><div><p dir="auto">To conclude, remember a simple variant that naturally encodes some data should remain a simple variant.</p></div></div></div><div class="heading-wrapper"><h2 data-heading="Conclusion" dir="auto" class="heading" id="Conclusion"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Conclusion</h2><div class="heading-children"><div><p dir="auto">Although polymorphic variants share a lot with simple variants, they are substantially different. This comes from the structural type-checking algorithm used for polymorphic variants.</p></div><div><ul>
<li data-line="0" dir="auto">Type declaration is optional</li>
<li data-line="1" dir="auto">A type is a set of constraints over values</li>
<li data-line="2" dir="auto">A Value satisfies its type rather than inhabits it</li>
<li data-line="3" dir="auto">Type expression designates sets of types</li>
<li data-line="4" dir="auto">There is a subtyping relation between types</li>
</ul></div><div><p dir="auto">Polymorphic variants should not be considered as an improvement over simple variants. In some regards, they are more flexible and lightweight, but they also have harder-to-read types and slightly weaker type-checking assurances. Choosing when to prefer polymorphic variants over simple variants is a subtle decision to make. It is safe to prefer simple variants as the default and go for polymorphic variants when there is a solid case for them.</p></div><div><p dir="auto">It is important to be comfortable with polymorphic variants, many projects are using them. Most often, only a fraction of their expressive strength is used. However, refactoring code using them requires being able to understand more than what's used. Otherwise, one may quickly end up stalled by indecipherable type error messages.</p></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#Polymorphic Variants"><div class="tree-item-contents heading-link" heading-name="Polymorphic Variants"><span class="tree-item-title">Polymorphic Variants</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#Introduction"><div class="tree-item-contents heading-link" heading-name="Introduction"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Introduction</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context)Origin_and_Context"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context)Origin and Context"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#origin-and-context" target="_blank"></a>Origin and Context</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism)A_Note_on_Simple_Variants_and_Polymorphism"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism)A Note on Simple Variants and Polymorphism"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#a-note-on-simple-variants-and-polymorphism" target="_blank"></a>A Note on Simple Variants and Polymorphism</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#a-first-example)A_First_Example"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#a-first-example)A First Example"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#a-first-example" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#a-first-example" target="_blank"></a>A First Example</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching)Creating_Polymorphic_Variant_Types_From_Pattern_Matching"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching)Creating Polymorphic Variant Types From Pattern Matching"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#creating-polymorphic-variant-types-from-pattern-matching" target="_blank"></a>Creating Polymorphic Variant Types From Pattern Matching</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing)Tag_Sharing"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing)Tag Sharing"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#tag-sharing" target="_blank"></a>Tag Sharing</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking)Static_Type-Checking"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking)Static Type-Checking"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#static-type-checking" target="_blank"></a>Static Type-Checking</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints)Merging_Constraints"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints)Merging Constraints"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#merging-constraints" target="_blank"></a>Merging Constraints</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants)Exact,_Closed_and_Open_Variants"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants)Exact, Closed and Open Variants"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#exact-closed-and-open-variants" target="_blank"></a>Exact, Closed and Open Variants</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant)Both_Open_and_Closed_Polymorphic_Variant"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant)Both Open and Closed Polymorphic Variant"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#both-open-and-closed-polymorphic-variant" target="_blank"></a>Both Open and Closed Polymorphic Variant</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants)Subtyping_of_Polymorphic_Variants"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants)Subtyping of Polymorphic Variants"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#subtyping-of-polymorphic-variants" target="_blank"></a>Subtyping of Polymorphic Variants</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types)Named_Polymorphic_Variant_Types"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types)Named Polymorphic Variant Types"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#named-polymorphic-variant-types" target="_blank"></a>Named Polymorphic Variant Types</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#naming)Naming"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#naming)Naming"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#naming" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#naming" target="_blank"></a>Naming</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#type-extension)Type_extension"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#type-extension)Type extension"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#type-extension" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#type-extension" target="_blank"></a>Type extension</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns)Hash_Patterns"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns)Hash Patterns"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#hash-patterns" target="_blank"></a>Hash Patterns</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants)Advanced:_Aliased,_Parametrized_and_Recursive_Polymorphic_Variants"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants)Advanced: Aliased, Parametrized and Recursive Polymorphic Variants"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#advanced-aliased-parametrized-and-recursive-polymorphic-variants" target="_blank"></a>Advanced: Aliased, Parametrized and Recursive Polymorphic Variants</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases)Inferred_Type_Aliases"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases)Inferred Type Aliases"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#inferred-type-aliases" target="_blank"></a>Inferred Type Aliases</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants)Parametrized_Polymorphic_Variants"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants)Parametrized Polymorphic Variants"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#parametrized-polymorphic-variants" target="_blank"></a>Parametrized Polymorphic Variants</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants)Recursive_Polymorphic_Variants"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants)Recursive Polymorphic Variants"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#recursive-polymorphic-variants" target="_blank"></a>Recursive Polymorphic Variants</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants)Advanced:_Combined_Subtyping_of_Polymorphic_and_Simple_Variants"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants)Advanced: Combined Subtyping of Polymorphic and Simple Variants"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#advanced-combined-subtyping-of-polymorphic-and-simple-variants" target="_blank"></a>Advanced: Combined Subtyping of Polymorphic and Simple Variants</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant)Predefined_Simple_Variants_are_Covariant"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant)Predefined Simple Variants are Covariant"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#predefined-simple-variants-are-covariant" target="_blank"></a>Predefined Simple Variants are Covariant</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant)Function_Codomains_are_Covariant"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant)Function Codomains are Covariant"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#function-codomains-are-covariant" target="_blank"></a>Function Codomains are Covariant</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant)Function_Domains_are_Contravariant"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant)Function Domains are Contravariant"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#function-domains-are-contravariant" target="_blank"></a>Function Domains are Contravariant</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work)Covariance_and_Contravariance_at_Work"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work)Covariance and Contravariance at Work"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#covariance-and-contravariance-at-work" target="_blank"></a>Covariance and Contravariance at Work</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#uses-cases)Uses-Cases"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#uses-cases)Uses-Cases"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#uses-cases" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#uses-cases" target="_blank"></a>Uses-Cases</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration)Variants_Without_Declaration"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration)Variants Without Declaration"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#variants-without-declaration" target="_blank"></a>Variants Without Declaration</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors)Shared_Constructors"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors)Shared Constructors"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#shared-constructors" target="_blank"></a>Shared Constructors</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules)Data_Type_Sharing_Between_Modules"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules)Data Type Sharing Between Modules"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#data-type-sharing-between-modules" target="_blank"></a>Data Type Sharing Between Modules</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type)Error_Handling_Using_the_`result`_Type"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type)Error Handling Using the `result` Type"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#error-handling-using-the-result-type" target="_blank"></a>Error Handling Using the <code>result</code> Type</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#drawbacks)Drawbacks"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#drawbacks)Drawbacks"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#drawbacks" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#drawbacks" target="_blank"></a>Drawbacks</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions)Hard-to-Read_Type_Expressions"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions)Hard-to-Read Type Expressions"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#hard-to-read-type-expressions" target="_blank"></a>Hard-to-Read Type Expressions</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types)Over_Constrained_Types"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types)Over Constrained Types"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#over-constrained-types" target="_blank"></a>Over Constrained Types</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging)Weaken_Type-Checking_and_Harder_Debugging"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging)Weaken Type-Checking and Harder Debugging"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#weaken-type-checking-and-harder-debugging" target="_blank"></a>Weaken Type-Checking and Harder Debugging</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#[](https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type)Over_Approximating_Type"><div class="tree-item-contents heading-link" heading-name="[](https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type)Over Approximating Type"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type" rel="noopener" class="external-link" href="https://staging.ocaml.org/docs/polymorphic-variants#over-approximating-type" target="_blank"></a>Over Approximating Type</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#Performances"><div class="tree-item-contents heading-link" heading-name="Performances"><span class="tree-item-title">Performances</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#When_to_Use_Polymorphic_Variant"><div class="tree-item-contents heading-link" heading-name="When to Use Polymorphic Variant"><span class="tree-item-title">When to Use Polymorphic Variant</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/ocaml/polymorphic-variants.html#Conclusion"><div class="tree-item-contents heading-link" heading-name="Conclusion"><span class="tree-item-title">Conclusion</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>