<!DOCTYPE html> <html><head>
		<title>Functional Reactive Programming</title>
		<base href="../../../">
		<meta id="root-path" root-path="../../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="韩暮秋的个人维基 - Functional Reactive Programming">
		<meta property="og:title" content="Functional Reactive Programming">
		<meta property="og:description" content="韩暮秋的个人维基 - Functional Reactive Programming">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://muqiuhan.github.io/wiki/computer-science/programming-language/fsharp/functional-reactive-programming.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="韩暮秋的个人维基">
		<meta name="author" content="韩暮秋"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://muqiuhan.github.io/wiki/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.ico"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-light show-inline-title show-ribbon pt-color-scheme-style-minimal-lt pt-accent-style-borderandfilled-lt pt-accent-color-grey-lt pt-highlight-text-accent-lt pt-accent-style-borderandfilled-dt pt-accent-color-purple-dt pt-highlight-text-accent-dt pt-focused-style-main-only pt-font-disable-ligatures pt-highlight-style-borderandfilled-lt pt-highlight-text-color-lt pt-highlight-style-borderandfilled-dt pt-highlight-text-color-dt pt-file-explorer-folder-icon-default pt-colored-folders-style-rainbow pt-center-kanban-title-text pt-kanban-background-grid-lt pt-kanban-background-grid-dt pt-icon-folder-accent"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Functional Reactive Programming"><p dir="auto">Functional Reactive Programming</p></h1><div><p dir="auto">Events are everywhere. Almost every program has to handle events, whether it be button clicks in the user interface, listening to sockets in a server, or even a system shutdown notification.</p></div><div><p dir="auto">And events are the basis of one of the most common OO design patterns: the “Observer” pattern.</p></div><div><p dir="auto">But as we know, event handling, like concurrency in general, can be tricky to implement. Simple event logic is straightforward, but what about logic like “do something if two events happen in a row but do something different if only one event happens” or “do something if two events happen at roughly the same time”. And how easy is it to combine these requirements in other, more complex ways?</p></div><div><p dir="auto">Even if you can successfully implement these requirements, the code tends to be spaghetti like and hard to understand, even with the best intentions.</p></div><div><p dir="auto">Is there an approach that can make event handling easier?</p></div><div><p dir="auto">We saw in the previous post on message queues that one of the advantages of that approach was that the requests were “serialized” making it conceptually easier to deal with.</p></div><div><p dir="auto">There is a similar approach that can be used with events. The idea is to turn a series of events into an “event stream”. Event streams then become quite like IEnumerables, and so the obvious next step is to treat them in much the the same way that LINQ handles collections, so that they can be filtered, mapped, split and combined.</p></div><div><p dir="auto">F# has built in support for this model, as well as for the more traditional approach.</p></div><div class="heading-wrapper"><h2 data-heading="A simple event stream" dir="auto" class="heading" id="A_simple_event_stream"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>A simple event stream</h2><div class="heading-children"><div><p dir="auto">Let’s start with a simple example to compare the two approaches. We’ll implement the classic event handler approach first.</p></div><div><p dir="auto">First, we define a utility function that will:</p></div><div><ul>
<li data-line="0" dir="auto">create a timer</li>
<li data-line="1" dir="auto">register a handler for the <code>Elapsed</code> event</li>
<li data-line="2" dir="auto">run the timer for five seconds and then stop it</li>
</ul></div><div><p dir="auto">Here’s the code:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">open</span> System
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading

<span class="token doc-comment comment">/// create a timer and register an event handler,</span>
<span class="token doc-comment comment">/// then run the timer for five seconds</span>
<span class="token keyword">let</span> createTimer timerInterval eventHandler <span class="token operator">=</span>
    <span class="token comment">// setup a timer</span>
    <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">System<span class="token punctuation">.</span>Timers<span class="token punctuation">.</span>Timer</span><span class="token punctuation">(</span>float timerInterval<span class="token punctuation">)</span>
    timer<span class="token punctuation">.</span>AutoReset <span class="token operator">&lt;-</span> <span class="token keyword">true</span>

    <span class="token comment">// add an event handler</span>
    timer<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span>Add eventHandler

    <span class="token comment">// return an async task</span>
    <span class="token computation-expression keyword">async</span> <span class="token punctuation">{</span>
        <span class="token comment">// start timer...</span>
        timer<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// ...run for five seconds...</span>
        <span class="token keyword">do</span><span class="token operator">!</span> Async<span class="token punctuation">.</span>Sleep <span class="token number">5000</span>
        <span class="token comment">// ... and stop</span>
        timer<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Now test it interactively:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// create a handler. The event args are ignored</span>
<span class="token keyword">let</span> basicHandler _ <span class="token operator">=</span> printfn <span class="token string">"tick %A"</span> DateTime<span class="token punctuation">.</span>Now

<span class="token comment">// register the handler</span>
<span class="token keyword">let</span> basicTimer1 <span class="token operator">=</span> createTimer <span class="token number">1000</span> basicHandler

<span class="token comment">// run the task now</span>
Async<span class="token punctuation">.</span>RunSynchronously basicTimer1
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Now let’s create a similar utility method to create a timer, but this time it will return an “observable” as well, which is the stream of events.</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">let</span> createTimerAndObservable timerInterval <span class="token operator">=</span>
    <span class="token comment">// setup a timer</span>
    <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">System<span class="token punctuation">.</span>Timers<span class="token punctuation">.</span>Timer</span><span class="token punctuation">(</span>float timerInterval<span class="token punctuation">)</span>
    timer<span class="token punctuation">.</span>AutoReset <span class="token operator">&lt;-</span> <span class="token keyword">true</span>

    <span class="token comment">// events are automatically IObservable</span>
    <span class="token keyword">let</span> observable <span class="token operator">=</span> timer<span class="token punctuation">.</span>Elapsed

    <span class="token comment">// return an async task</span>
    <span class="token keyword">let</span> task <span class="token operator">=</span> <span class="token computation-expression keyword">async</span> <span class="token punctuation">{</span>
        timer<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">do</span><span class="token operator">!</span> Async<span class="token punctuation">.</span>Sleep <span class="token number">5000</span>
        timer<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

    <span class="token comment">// return a async task and the observable</span>
    <span class="token punctuation">(</span>task<span class="token punctuation">,</span>observable<span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">And again test it interactively:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// create the timer and the corresponding observable</span>
<span class="token keyword">let</span> basicTimer2 <span class="token punctuation">,</span> timerEventStream <span class="token operator">=</span> createTimerAndObservable <span class="token number">1000</span>

<span class="token comment">// register that every time something happens on the</span>
<span class="token comment">// event stream, print the time.</span>
timerEventStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"tick %A"</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">)</span>

<span class="token comment">// run the task now</span>
Async<span class="token punctuation">.</span>RunSynchronously basicTimer2
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The difference is that instead of registering a handler directly with an event, we are “subscribing” to an event stream. Subtly different, and important.</p></div></div></div><div class="heading-wrapper"><h2 data-heading="Counting events[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events)" dir="auto" class="heading" id="Counting_events[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Counting events<a data-tooltip-position="top" aria-label="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events" rel="noopener" class="external-link" href="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events" target="_blank"></a></h2><div class="heading-children"><div><p dir="auto">In this next example, we’ll have a slightly more complex requirement:</p></div><div><pre><code>Create a timer that ticks every 500ms.
At each tick, print the number of ticks so far and the current time.
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">To do this in a classic imperative way, we would probably create a class with a mutable counter, as below:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">type</span> <span class="token class-name">ImperativeTimerCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span>

    <span class="token keyword">let</span> <span class="token keyword">mutable</span> count <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment">// the event handler. The event args are ignored</span>
    <span class="token keyword">member</span> this<span class="token punctuation">.</span>handleEvent _ <span class="token operator">=</span>
      count <span class="token operator">&lt;-</span> count <span class="token operator">+</span> <span class="token number">1</span>
      printfn <span class="token string">"timer ticked with count %i"</span> count
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">We can reuse the utility functions we created earlier to test it:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// create a handler class</span>
<span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImperativeTimerCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// register the handler method</span>
<span class="token keyword">let</span> timerCount1 <span class="token operator">=</span> createTimer <span class="token number">500</span> handler<span class="token punctuation">.</span>handleEvent

<span class="token comment">// run the task now</span>
Async<span class="token punctuation">.</span>RunSynchronously timerCount1
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Let’s see how we would do this same thing in a functional way:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// create the timer and the corresponding observable</span>
<span class="token keyword">let</span> timerCount2<span class="token punctuation">,</span> timerEventStream <span class="token operator">=</span> createTimerAndObservable <span class="token number">500</span>

<span class="token comment">// set up the transformations on the event stream</span>
timerEventStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>scan <span class="token punctuation">(</span><span class="token keyword">fun</span> count _ <span class="token operator">-&gt;</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> count <span class="token operator">-&gt;</span> printfn <span class="token string">"timer ticked with count %i"</span> count<span class="token punctuation">)</span>

<span class="token comment">// run the task now</span>
Async<span class="token punctuation">.</span>RunSynchronously timerCount2
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Here we see how you can build up layers of event transformations, just as you do with list transformations in LINQ.</p></div><div><p dir="auto">The first transformation is <code>scan</code>, which accumulates state for each event. It is roughly equivalent to the <code>List.fold</code> function that we have seen used with lists. In this case, the accumulated state is just a counter.</p></div><div><p dir="auto">And then, for each event, the count is printed out.</p></div><div><p dir="auto">Note that in this functional approach, we didn’t have any mutable state, and we didn’t need to create any special classes.</p></div></div></div><div class="heading-wrapper"><h2 data-heading="Merging multiple event streams[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams)" dir="auto" class="heading" id="Merging_multiple_event_streams[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Merging multiple event streams<a data-tooltip-position="top" aria-label="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams" rel="noopener" class="external-link" href="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams" target="_blank"></a></h2><div class="heading-children"><div><p dir="auto">For a final example, we’ll look at merging multiple event streams.</p></div><div><p dir="auto">Let’s make a requirement based on the well-known “FizzBuzz” problem:</p></div><div><pre><code>Create two timers, called '3' and '5'. The '3' timer ticks every 300ms and the '5' timer ticks
every 500ms.

Handle the events as follows:
a) for all events, print the id of the time and the time
b) when a tick is simultaneous with a previous tick, print 'FizzBuzz'
otherwise:
c) when the '3' timer ticks on its own, print 'Fizz'
d) when the '5' timer ticks on its own, print 'Buzz'
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">First let’s create some code that both implementations can use.</p></div><div><p dir="auto">We’ll want a generic event type that captures the timer id and the time of the tick.</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">type</span> <span class="token class-name">FizzBuzzEvent</span> <span class="token operator">=</span> <span class="token punctuation">{</span>label<span class="token punctuation">:</span><span class="token class-name">int</span><span class="token punctuation">;</span> time<span class="token punctuation">:</span> <span class="token class-name">DateTime</span><span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">And then we need a utility function to see if two events are simultaneous. We’ll be generous and allow a time difference of up to 50ms.</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">let</span> areSimultaneous <span class="token punctuation">(</span>earlierEvent<span class="token punctuation">,</span>laterEvent<span class="token punctuation">)</span> <span class="token operator">=</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>_<span class="token punctuation">;</span>time<span class="token operator">=</span>t1<span class="token punctuation">}</span> <span class="token operator">=</span> earlierEvent
    <span class="token keyword">let</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>_<span class="token punctuation">;</span>time<span class="token operator">=</span>t2<span class="token punctuation">}</span> <span class="token operator">=</span> laterEvent
    t2<span class="token punctuation">.</span><span class="token function">Subtract</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">.</span>Milliseconds <span class="token operator">&lt;</span> <span class="token number">50</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">In the imperative design, we’ll need to keep track of the previous event, so we can compare them. And we’ll need special case code for the first time, when the previous event doesn’t exist</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">type</span> <span class="token class-name">ImperativeFizzBuzzHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span>

    <span class="token keyword">let</span> <span class="token keyword">mutable</span> previousEvent<span class="token punctuation">:</span> <span class="token class-name">FizzBuzzEvent</span> option <span class="token operator">=</span> None

    <span class="token keyword">let</span> printEvent thisEvent  <span class="token operator">=</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>id<span class="token punctuation">;</span> time<span class="token operator">=</span>t<span class="token punctuation">}</span> <span class="token operator">=</span> thisEvent
      printf <span class="token string">"[%i] %i.%03i "</span> id t<span class="token punctuation">.</span>Second t<span class="token punctuation">.</span>Millisecond
      <span class="token keyword">let</span> simultaneous <span class="token operator">=</span> previousEvent<span class="token punctuation">.</span>IsSome <span class="token operator">&amp;&amp;</span> areSimultaneous <span class="token punctuation">(</span>previousEvent<span class="token punctuation">.</span>Value<span class="token punctuation">,</span>thisEvent<span class="token punctuation">)</span>
      <span class="token keyword">if</span> simultaneous <span class="token keyword">then</span> printfn <span class="token string">"FizzBuzz"</span>
      <span class="token keyword">elif</span> id <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">then</span> printfn <span class="token string">"Fizz"</span>
      <span class="token keyword">elif</span> id <span class="token operator">=</span> <span class="token number">5</span> <span class="token keyword">then</span> printfn <span class="token string">"Buzz"</span>

    <span class="token keyword">member</span> this<span class="token punctuation">.</span>handleEvent3 eventArgs <span class="token operator">=</span>
      <span class="token keyword">let</span> <span class="token keyword">event</span> <span class="token operator">=</span> <span class="token punctuation">{</span>label<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> time<span class="token operator">=</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">}</span>
      printEvent <span class="token keyword">event</span>
      previousEvent <span class="token operator">&lt;-</span> Some <span class="token keyword">event</span>

    <span class="token keyword">member</span> this<span class="token punctuation">.</span>handleEvent5 eventArgs <span class="token operator">=</span>
      <span class="token keyword">let</span> <span class="token keyword">event</span> <span class="token operator">=</span> <span class="token punctuation">{</span>label<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> time<span class="token operator">=</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">}</span>
      printEvent <span class="token keyword">event</span>
      previousEvent <span class="token operator">&lt;-</span> Some <span class="token keyword">event</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Now the code is beginning to get ugly fast! Already we have mutable state, complex conditional logic, and special cases, just for such a simple requirement.</p></div><div><p dir="auto">Let’s test it:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// create the class</span>
<span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImperativeFizzBuzzHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// create the two timers and register the two handlers</span>
<span class="token keyword">let</span> timer3 <span class="token operator">=</span> createTimer <span class="token number">300</span> handler<span class="token punctuation">.</span>handleEvent3
<span class="token keyword">let</span> timer5 <span class="token operator">=</span> createTimer <span class="token number">500</span> handler<span class="token punctuation">.</span>handleEvent5

<span class="token comment">// run the two timers at the same time</span>
<span class="token punctuation">[</span>timer3<span class="token punctuation">;</span>timer5<span class="token punctuation">]</span>
<span class="token operator">|&gt;</span> Async<span class="token punctuation">.</span>Parallel
<span class="token operator">|&gt;</span> Async<span class="token punctuation">.</span>RunSynchronously
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">It does work, but are you sure the code is not buggy? Are you likely to accidentally break something if you change it?</p></div><div><p dir="auto">The problem with this imperative code is that it has a lot of noise that obscures the the requirements.</p></div><div><p dir="auto">Can the functional version do better? Let’s see!</p></div><div><p dir="auto">First, we create <em>two</em> event streams, one for each timer:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token keyword">let</span> timer3<span class="token punctuation">,</span> timerEventStream3 <span class="token operator">=</span> createTimerAndObservable <span class="token number">300</span>
<span class="token keyword">let</span> timer5<span class="token punctuation">,</span> timerEventStream5 <span class="token operator">=</span> createTimerAndObservable <span class="token number">500</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Next, we convert each event on the “raw” event streams into our FizzBuzz event type:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// convert the time events into FizzBuzz events with the appropriate id</span>
<span class="token keyword">let</span> eventStream3  <span class="token operator">=</span>
   timerEventStream3
   <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>label<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> time<span class="token operator">=</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> eventStream5  <span class="token operator">=</span>
   timerEventStream5
   <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>label<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> time<span class="token operator">=</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Now, to see if two events are simultaneous, we need to compare them from the two different streams somehow.</p></div><div><p dir="auto">It’s actually easier than it sounds, because we can:</p></div><div><ul>
<li data-line="0" dir="auto">combine the two streams into a single stream:</li>
<li data-line="1" dir="auto">then create pairs of sequential events</li>
<li data-line="2" dir="auto">then test the pairs to see if they are simultaneous</li>
<li data-line="3" dir="auto">then split the input stream into two new output streams based on that test</li>
</ul></div><div><p dir="auto">Here’s the actual code to do this:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// combine the two streams</span>
<span class="token keyword">let</span> combinedStream <span class="token operator">=</span>
    Observable<span class="token punctuation">.</span>merge eventStream3 eventStream5

<span class="token comment">// make pairs of events</span>
<span class="token keyword">let</span> pairwiseStream <span class="token operator">=</span>
   combinedStream <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>pairwise

<span class="token comment">// split the stream based on whether the pairs are simultaneous</span>
<span class="token keyword">let</span> simultaneousStream<span class="token punctuation">,</span> nonSimultaneousStream <span class="token operator">=</span>
    pairwiseStream <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>partition areSimultaneous
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Finally, we can split the <code>nonSimultaneousStream</code> again, based on the event id:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// split the non-simultaneous stream based on the id</span>
<span class="token keyword">let</span> fizzStream<span class="token punctuation">,</span> buzzStream  <span class="token operator">=</span>
    nonSimultaneousStream
    <span class="token comment">// convert pair of events to the first event</span>
    <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">(</span>ev1<span class="token punctuation">,</span>_<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> ev1<span class="token punctuation">)</span>
    <span class="token comment">// split on whether the event id is three</span>
    <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>partition <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>id<span class="token punctuation">}</span> <span class="token operator">-&gt;</span> id<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Let’s review so far. We have started with the two original event streams and from them created four new ones:</p></div><div><ul>
<li data-line="0" dir="auto"><code>combinedStream</code> contains all the events</li>
<li data-line="1" dir="auto"><code>simultaneousStream</code> contains only the simultaneous events</li>
<li data-line="2" dir="auto"><code>fizzStream</code> contains only the non-simultaneous events with id=3</li>
<li data-line="3" dir="auto"><code>buzzStream</code> contains only the non-simultaneous events with id=5</li>
</ul></div><div><p dir="auto">Now all we need to do is attach behavior to each stream:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">//print events from the combinedStream</span>
combinedStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>id<span class="token punctuation">;</span>time<span class="token operator">=</span>t<span class="token punctuation">}</span> <span class="token operator">-&gt;</span>
                              printf <span class="token string">"[%i] %i.%03i "</span> id t<span class="token punctuation">.</span>Second t<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>

<span class="token comment">//print events from the simultaneous stream</span>
simultaneousStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"FizzBuzz"</span><span class="token punctuation">)</span>

<span class="token comment">//print events from the nonSimultaneous streams</span>
fizzStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"Fizz"</span><span class="token punctuation">)</span>

buzzStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"Buzz"</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Let’s test it:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// run the two timers at the same time</span>
<span class="token punctuation">[</span>timer3<span class="token punctuation">;</span>timer5<span class="token punctuation">]</span>
<span class="token operator">|&gt;</span> Async<span class="token punctuation">.</span>Parallel
<span class="token operator">|&gt;</span> Async<span class="token punctuation">.</span>RunSynchronously
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">Here’s all the code in one complete set:</p></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// create the event streams and raw observables</span>
<span class="token keyword">let</span> timer3<span class="token punctuation">,</span> timerEventStream3 <span class="token operator">=</span> createTimerAndObservable <span class="token number">300</span>
<span class="token keyword">let</span> timer5<span class="token punctuation">,</span> timerEventStream5 <span class="token operator">=</span> createTimerAndObservable <span class="token number">500</span>

<span class="token comment">// convert the time events into FizzBuzz events with the appropriate id</span>
<span class="token keyword">let</span> eventStream3  <span class="token operator">=</span> timerEventStream3
                    <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>label<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> time<span class="token operator">=</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> eventStream5  <span class="token operator">=</span> timerEventStream5
                    <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>label<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> time<span class="token operator">=</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// combine the two streams</span>
<span class="token keyword">let</span> combinedStream <span class="token operator">=</span>
   Observable<span class="token punctuation">.</span>merge eventStream3 eventStream5

<span class="token comment">// make pairs of events</span>
<span class="token keyword">let</span> pairwiseStream <span class="token operator">=</span>
   combinedStream <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>pairwise

<span class="token comment">// split the stream based on whether the pairs are simultaneous</span>
<span class="token keyword">let</span> simultaneousStream<span class="token punctuation">,</span> nonSimultaneousStream <span class="token operator">=</span>
   pairwiseStream <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>partition areSimultaneous

<span class="token comment">// split the non-simultaneous stream based on the id</span>
<span class="token keyword">let</span> fizzStream<span class="token punctuation">,</span> buzzStream  <span class="token operator">=</span>
    nonSimultaneousStream
    <span class="token comment">// convert pair of events to the first event</span>
    <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">(</span>ev1<span class="token punctuation">,</span>_<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> ev1<span class="token punctuation">)</span>
    <span class="token comment">// split on whether the event id is three</span>
    <span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>partition <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>id<span class="token punctuation">}</span> <span class="token operator">-&gt;</span> id<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment">//print events from the combinedStream</span>
combinedStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">{</span>label<span class="token operator">=</span>id<span class="token punctuation">;</span>time<span class="token operator">=</span>t<span class="token punctuation">}</span> <span class="token operator">-&gt;</span>
                              printf <span class="token string">"[%i] %i.%03i "</span> id t<span class="token punctuation">.</span>Second t<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>

<span class="token comment">//print events from the simultaneous stream</span>
simultaneousStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"FizzBuzz"</span><span class="token punctuation">)</span>

<span class="token comment">//print events from the nonSimultaneous streams</span>
fizzStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"Fizz"</span><span class="token punctuation">)</span>

buzzStream
<span class="token operator">|&gt;</span> Observable<span class="token punctuation">.</span>subscribe <span class="token punctuation">(</span><span class="token keyword">fun</span> _ <span class="token operator">-&gt;</span> printfn <span class="token string">"Buzz"</span><span class="token punctuation">)</span>

<span class="token comment">// run the two timers at the same time</span>
<span class="token punctuation">[</span>timer3<span class="token punctuation">;</span>timer5<span class="token punctuation">]</span>
<span class="token operator">|&gt;</span> Async<span class="token punctuation">.</span>Parallel
<span class="token operator">|&gt;</span> Async<span class="token punctuation">.</span>RunSynchronously
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">The code might seem a bit long winded, but this kind of incremental, step-wise approach is very clear and self-documenting.</p></div><div><p dir="auto">Some of the benefits of this style are:</p></div><div><ul>
<li data-line="0" dir="auto">I can see that it meets the requirements just by looking at it, without even running it. Not so with the imperative version.</li>
<li data-line="1" dir="auto">From a design point of view, each final “output” stream follows the single responsibility principle – it only does one thing – so it is very easy to associate behavior with it.</li>
<li data-line="2" dir="auto">This code has no conditionals, no mutable state, no edge cases. It would be easy to maintain or change, I hope.</li>
<li data-line="3" dir="auto">It is easy to debug. For example, I could easily “tap” the output of the <code>simultaneousStream</code> to see if it contains what I think it contains:</li>
</ul></div><div><pre class="language-fsharp" tabindex="0"><code class="language-fsharp is-loaded"><span class="token comment">// debugging code</span>
<span class="token comment">//simultaneousStream |&gt; Observable.subscribe (fun e -&gt; printfn "sim %A" e)</span>
<span class="token comment">//nonSimultaneousStream |&gt; Observable.subscribe (fun e -&gt; printfn "non-sim %A" e)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">This would be much harder in the imperative version.</p></div></div></div><div class="heading-wrapper"><h2 data-heading="Summary[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary)" dir="auto" class="heading" id="Summary[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Summary<a data-tooltip-position="top" aria-label="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary" rel="noopener" class="external-link" href="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary" target="_blank"></a></h2><div class="heading-children"><div><p dir="auto">Functional Reactive Programming (known as FRP) is a big topic, and we’ve only just touched on it here. I hope this introduction has given you a glimpse of the usefulness of this way of doing things.</p></div><div><p dir="auto">If you want to learn more, see the documentation for the F# <a data-tooltip-position="top" aria-label="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/ee370313%28v=vs.100%29?redirectedfrom=MSDN" rel="noopener" class="external-link" href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/ee370313%28v=vs.100%29?redirectedfrom=MSDN" target="_blank">Observable module</a>, which has the basic transformations used above. And there is also the <a data-tooltip-position="top" aria-label="https://docs.microsoft.com/en-us/previous-versions/dotnet/reactive-extensions/hh242985%28v=vs.103%29" rel="noopener" class="external-link" href="https://docs.microsoft.com/en-us/previous-versions/dotnet/reactive-extensions/hh242985%28v=vs.103%29" target="_blank">Reactive Extensions (Rx)</a> library which shipped as part of .NET 4. That contains many other additional transformations.</p></div><div><hr></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="computer-science/programming-language/fsharp/functional-reactive-programming.html#Functional Reactive Programming"><div class="tree-item-contents heading-link" heading-name="Functional Reactive Programming"><span class="tree-item-title">Functional Reactive Programming</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/fsharp/functional-reactive-programming.html#A_simple_event_stream"><div class="tree-item-contents heading-link" heading-name="A simple event stream"><span class="tree-item-title">A simple event stream</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/fsharp/functional-reactive-programming.html#Counting_events[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events)"><div class="tree-item-contents heading-link" heading-name="Counting events[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events)"><span class="tree-item-title">Counting events<a data-tooltip-position="top" aria-label="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events" rel="noopener" class="external-link" href="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#counting-events" target="_blank"></a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/fsharp/functional-reactive-programming.html#Merging_multiple_event_streams[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams)"><div class="tree-item-contents heading-link" heading-name="Merging multiple event streams[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams)"><span class="tree-item-title">Merging multiple event streams<a data-tooltip-position="top" aria-label="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams" rel="noopener" class="external-link" href="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#merging-multiple-event-streams" target="_blank"></a></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/fsharp/functional-reactive-programming.html#Summary[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary)"><div class="tree-item-contents heading-link" heading-name="Summary[](https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary)"><span class="tree-item-title">Summary<a data-tooltip-position="top" aria-label="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary" rel="noopener" class="external-link" href="https://fsharpforfunandprofit.com/posts/concurrency-reactive/#summary" target="_blank"></a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>