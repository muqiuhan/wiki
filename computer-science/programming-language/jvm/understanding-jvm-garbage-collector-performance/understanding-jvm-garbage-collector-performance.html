<!DOCTYPE html> <html><head>
		<title>Understanding JVM Garbage Collector Performance</title>
		<base href="../../../../">
		<meta id="root-path" root-path="../../../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="韩暮秋的个人维基 - Understanding JVM Garbage Collector Performance">
		<meta property="og:title" content="Understanding JVM Garbage Collector Performance">
		<meta property="og:description" content="韩暮秋的个人维基 - Understanding JVM Garbage Collector Performance">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://muqiuhan.github.io/wiki/computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html">
		<meta property="og:image" content="https://muqiuhan.github.io/wiki/computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111190234.png">
		<meta property="og:site_name" content="韩暮秋的个人维基">
		<meta name="author" content="韩暮秋"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://muqiuhan.github.io/wiki/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-light show-inline-title show-ribbon outliner-plugin-dnd custom-accent ribbon-default special-h6 float-center"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles">mjx-munder{display:inline-block;text-align:left}mjx-over{text-align:left}mjx-munder:not([limits=false]){display:inline-table}mjx-munder>mjx-row{text-align:left}mjx-under{padding-bottom:.1em}mjx-msub{display:inline-block;text-align:left}mjx-c.mjx-c1D436.TEX-I::before{padding:.705em .76em .022em 0;content:"C"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}mjx-c.mjx-c2211.TEX-S2::before{padding:.95em 1.444em .45em 0;content:"∑"}mjx-c.mjx-c1D45D.TEX-I::before{padding:.442em .503em .194em 0;content:"p"}mjx-c.mjx-c1D461.TEX-I::before{padding:.626em .361em .011em 0;content:"t"}mjx-mtext{display:inline-block;text-align:left}mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;font-size-adjust:none;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-msup{display:inline-block;text-align:left}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-texatom{display:inline-block;text-align:left}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("lib/fonts/mathjax_vector-bold.woff") format("woff")}mjx-c.mjx-c1D447.TEX-I::before{padding:.677em .704em 0 0;content:"T"}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c2C::before{padding:.121em .278em .194em 0;content:","}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}</style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Understanding JVM Garbage Collector Performance"><p dir="auto">Understanding JVM Garbage Collector Performance</p></h1><div class="el-p"><p dir="auto"><a href="?query=tag:jvm" class="tag" target="_blank" rel="noopener nofollow">#jvm</a> <a href="?query=tag:gc" class="tag" target="_blank" rel="noopener nofollow">#gc</a></p></div><div class="el-blockquote"><blockquote dir="auto">
<p><a rel="noopener nofollow" class="external-link" href="https://mill-build.org/blog/6-garbage-collector-perf.html" target="_blank">https://mill-build.org/blog/6-garbage-collector-perf.html</a></p>
</blockquote></div><div class="el-h2 heading-wrapper"><h2 data-heading="TL;DR" dir="auto" class="heading" id="TL;DR"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>TL;DR</h2><div class="heading-children"><div class="el-p"><p dir="auto">从理论上来说，GC的性能主要集中在两个方面，一是程序用于收集垃圾的时间百分比，而不是实际工作，这个值越低越好。二是程序在收集垃圾时完全暂停的最长时间，这个值也是越低越好。</p></div><div class="el-p"><p dir="auto">分开这两个指标的原因是：</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">有些程序只关心自身的运行，例如，如果一个程序只关心完成大批量分析需要多长时间，而不关心 GC 是否会导致它中途暂停。</li>
<li data-line="1" dir="auto">其他程序只关心暂停时间，例如，玩电子游戏的人并不关心它是否能跑得比他们的眼睛能感知的更快，但他们关心它不会在爽玩时暂停明显的时间。</li>
</ul></div><div class="el-p"><p dir="auto">从这些有限描述中可以对简单垃圾回收器的性能做出一些理论上的推断：</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>暂停时间应与 live-set 的大小成正比</strong>。这是因为集合涉及跟踪、复制和更新 live-set 中的引用。</li>
<li data-line="1" dir="auto">暂停时间不取决于要收集的垃圾量。收集器根本没有花时间查看或扫描垃圾对象，它们所在的堆在垃圾收集后会被直接擦除。</li>
<li data-line="2" dir="auto">集合之间的间隔与可用内存成反比。只需要在分配的垃圾填满了程序在存储 live-set 所需的 “额外” 堆内存时运行垃圾收集。</li>
<li data-line="3" dir="auto"><strong>GC 开销是暂停时间除以间隔，或与额外内存成正比，与实时集大小和堆大小成反比</strong></li>
</ul></div><div class="el-p"><p dir="auto">换言之：</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><code>allocation_cost = O(1)</code></li>
<li data-line="1" dir="auto"><code>gc_pause_time = O(live-set)</code></li>
<li data-line="2" dir="auto"><code>gc_interval = O(heap-size - live-set)</code></li>
<li data-line="3" dir="auto"><code>gc_overhead = gc_pause_time / gc_interval</code></li>
<li data-line="4" dir="auto"><code>gc_overhead = O(live-set / (heap-size - live-set))</code></li>
</ul></div><div class="el-p"><p dir="auto">从这个结论中，可以看到一些不直观的结果：</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>更多的内存不会减少暂停时间</strong>: <code>gc_pause_time = O（live-set）</code>，因此暂停时间不取决于你有多少<code>堆大小</code>。</li>
<li data-line="1" dir="auto"><strong>提供更多内存不会改善 GC 开销</strong>:  <code>gc_overhead = O(live-set / (heap-size - live-set))</code> ，因此提供越大的堆大小才能拥有更少的 GC 开销（将更大百分比的程序时间花在有用的工作上）。</li>
<li data-line="2" dir="auto"><strong>相反，提供与程序完全相同的内存是最坏的情况！</strong> <code>gc_overhead = O(live-set / (heap-size - live-set))</code> 什么时候 <code>heap-size = live-set</code> 表示 <code>gc_interval = 0</code> 且 <code>gc_overhead = 无穷大</code>：程序将不断需要运行开销极大的收集器，并且没有时间执行实际工作。因此，垃圾回收器需要额外的内存才能使用，此外，还需要分配程序中的所有对象所需的内存。</li>
</ul></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto">Garbage collectors are a core part of many programming languages. While they generally work well, on occasion when they go wrong they can fail in very unintuitive ways. This article will discuss the fundamental design of how garbage collectors work, and tie it to real benchmarks of how GCs perform on the Java Virtual Machine. You should come away with a deeper understanding of how the JVM garbage collector works and concrete ways you can work to improve its performance in your own real-world projects.</p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="A Theoretical Garbage Collector" dir="auto" class="heading" id="A_Theoretical_Garbage_Collector"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>A Theoretical Garbage Collector</h2><div class="heading-children"><div class="el-p"><p dir="auto">To understand how real-world JVM garbage collectors works, it is best to start by looking at a simple example garbage collector. This will both give an intuition for how things work in general, and also help you notice when things diverge from this idealized example.</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Process Memory" dir="auto" class="heading" id="Process_Memory"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Process Memory</h3><div class="heading-children"><div class="el-p"><p dir="auto">At its core, a garbage collector helps manage the free memory of a program, often called the <em>heap</em>. The memory of a program can be modelled as a linear sequence of storage locations, e.g. below where we have 16 slots in memory:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111190234.png" src="Pasted image 20250111190234.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111190234.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111190234.png"></span><br>
These storage locations can contain objects (below named <code>foo</code>, <code>bar</code>, <code>qux</code>, <code>baz</code>) that take up memory and may reference other objects (solid arrows). Furthermore, the values may be referenced from outside the heap (dashed lines), e.g. from the "stack" which represents local variables in methods that are currently being run (shown below) or from static global variables (not shown). We keep a <code>free-memory</code> pointer to the first empty slot on the right.</p></div><div class="el-p"><p dir="auto">If we want to allocate a new object <code>new1</code>, we can simply put it at the location of the <code>free-memory</code> pointer (green below), and bump the pointer 1 slot to the right:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111190404.png" src="Pasted image 20250111190404.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111190404.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111190404.png"></span><br>
Similarly, objects may stop being referenced, e.g. <code>bar</code> below no longer has a reference pointing at it from the stack. This may happen because a local variable on the stack is set to <code>null</code>, or because a method call returned and the local variables associated with it are no longer necessary:<br>
<span alt="Pasted image 20250111190441.png" src="Pasted image 20250111190441.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111190441.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111190441.png"></span><br>
For the purposes of this example, we show all objects on the heap taking up 1 slot, but in real programs the size of each object may vary depending on the fields it has or if it’s a variable-length array.</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="A Simple Garbage Collector" dir="auto" class="heading" id="A_Simple_Garbage_Collector"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>A Simple Garbage Collector</h3><div class="heading-children"><div class="el-p"><p dir="auto">The simplest kind of garbage collector splits the 16-slot heap we saw earlier into two 8-slot halves. If we want to allocate 4 more objects (<code>new2</code>, to <code>new5</code>), but there are only 3 slots left in that half of the heap, we will need to do a collection:<br>
<span alt="Pasted image 20250111190820.png" src="Pasted image 20250111190820.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111190820.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111190820.png"></span><br>
To do a collection, the GC first starts from all non-heap references (e.g. the <code>STACK</code> references above) often called "GC roots". It then traces the graph of references, highlighted red below:<br>
<span alt="Pasted image 20250111190859.png" src="Pasted image 20250111190859.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111190859.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111190859.png"></span><br>
Here, we can see that <code>foo</code> is not referenced ("garbage"), <code>qux</code> and <code>new1</code> are referenced directly from the <code>STACK</code>, and <code>baz</code> is referenced indirectly from <code>qux</code>. <code>bar</code> is referenced by <code>foo</code>, but because <code>foo</code> is itself garbage we can count <code>bar</code> as garbage as well.</p></div><div class="el-p"><p dir="auto">We then copy all objects we traced (often called the <em>live-set</em>) from <code>HALF1</code> to <code>HALF2</code>, adjust all the references appropriately. Now <code>HALF2</code> is the half of the heap in use, and <code>HALF1</code> can be reset to empty:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111191028.png" src="Pasted image 20250111191028.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191028.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191028.png"></span><br>
This collection has freed up 5 slots, so we now have space to allocate the 4 <code>new2</code> to <code>new5</code> objects we wanted (green) starting from our <code>free-memory</code> pointer:<br>
<span alt="Pasted image 20250111191058.png" src="Pasted image 20250111191058.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191058.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191058.png"></span></p></div><div class="el-p"><p dir="auto">You may notice that the objects <code>foo</code> and <code>bar</code> disappeared. This is because <code>foo</code> and <code>bar</code> were not referenced directly or indirectly by any GC roots: they were unreachable, and thus considered "garbage". These garbage objects were not explicitly deleted, but simply did not get copied over from <code>HALF1</code> to <code>HALF2</code> during collection, and thus were wiped out when <code>HALF1</code> was cleared.</p></div><div class="el-p"><p dir="auto">As your program executes, the methods actively running may change, and thus the references (both from stack to heap and between entries on your heap) may change. For example, we may stop referencing <code>qux</code>, which also means that <code>baz</code> is now unreachable:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111191142.png" src="Pasted image 20250111191142.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191142.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191142.png"></span></p></div><div class="el-p"><p dir="auto">Although <code>qux</code> and <code>baz</code> are now "garbage", they still take up space in the heap. Thus, if we want to allocate two new objects (e.g. <code>new6</code> and <code>new7</code>), and there is only one slot left on the heap (above), we need to repeat the garbage collection process: tracing the objects transitively reachable (<code>new1</code>, <code>new2</code>, <code>new3</code>, <code>new4</code>, <code>new5</code>), copying them from <code>HALF2</code> to <code>HALF1</code>, adjusting any references to now use <code>HALF1</code> as the new heap, and clearing anything that was left behind in <code>HALF2</code>. This then gives us enough space to allocate <code>new6</code> and <code>new7</code> (below in green):</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111191255.png" src="Pasted image 20250111191255.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191255.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191255.png"></span></p></div><div class="el-p"><p dir="auto">This process can repeat as many times as necessary: as long as there are <em>some</em> objects that are unreachable, you can run a collection and copy the "live" objects to the other half of the heap, freeing up some space to allocate new objects. The only reason this may fail is that if you run a collection and there <em>still</em> isn’t enough space to allocate the objects you want; that means your program has run out of memory, and will fail with an <code>OutOfMemoryError</code> or similar.</p></div><div class="el-p"><p dir="auto">Even this simplistic GC has a lot of interesting properties, and you may have heard these terms or labels that can apply to it:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>semi-space</strong> garbage collector, because of the way it splits the heap into two halves</li>
<li data-line="1" dir="auto"><strong>copying</strong> garbage collector, because it needs to copy the heap objects back and forth between <code>HALF1</code> and <code>HALF2</code></li>
<li data-line="2" dir="auto"><strong>tracing</strong> garbage collector, because of the way it traverses the graph of heap references in order to decide what to copy.</li>
<li data-line="3" dir="auto"><strong>stop the world</strong> garbage collector, because while this whole trace-copy-update-references workflow is happening, we have to stop the program to avoid race conditions between the garbage collector and the program code.</li>
<li data-line="4" dir="auto"><strong>compacting</strong> garbage collector, because every time we run a GC, we copy everything to the left-most memory, avoiding the memory fragmentation that occurs with other memory management techniques such as <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Reference_counting" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Reference_counting" target="_blank">Reference Counting</a>.</li>
</ul></div><div class="el-p"><p dir="auto">Most modern GCs are considerably more complicated than this: e.g. they may have optimizations to avoid wasting half the heap by leaving it empty, or they may have <em>optimizations for handling short-lived objects</em>, but at their heart this is still what they do. And understanding the performance characteristics of this simple, naive GC can help give you an intuition in how GCs compare to other memory management strategies, and how modern GCs behave in terms of performance.</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Compared to Reference Counting" dir="auto" class="heading" id="Compared_to_Reference_Counting"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Compared to Reference Counting</h2><div class="heading-children"><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Reference_counting" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Reference_counting" target="_blank">Reference Counting</a> is another popular memory management strategy that Garbage Collection is often compared to. Reference counting works by keeping track of how many incoming references each object has, and when that number reaches zero the object can be collected. This approach has a few major differences from that of a tracing GC. We discuss a few of them below:</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Reference counting does not compact the heap" dir="auto" class="heading" id="Reference_counting_does_not_compact_the_heap"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Reference counting does not compact the heap</h3><div class="heading-children"><div class="el-p"><p dir="auto">Program that use reference counting tend to find their heap getting more and more fragmented over time We can see this in the heap diagrams: the tracing garbage collector heaps above always had a single block of empty space to the right, and had the <code>new</code> objects allocated in ascending order from left-to-right:<br>
<span alt="Pasted image 20250111191658.png" src="Pasted image 20250111191658.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191658.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191658.png"></span><br>
In contrast, reference counted heaps (e.g. below) tend to get fragmented, with free space scattered about, and the allocated objects jumbled up in no particular order:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111191743.png" src="Pasted image 20250111191743.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191743.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191743.png"></span></p></div><div class="el-p"><p dir="auto">There are two main ways this affect performance:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">With garbage collection all the free memory is always on the right in one contiguous block, so an allocation just involves putting the object at the <code>free-pointer</code> location and moving <code>free-pointer</code> one slot to the right. Furthermore, newly allocated objects (which tend to be used together) are placed next to each other, making them more cache-friendly and improving access performance.</li>
<li data-line="1" dir="auto">With reference counting objects are usually freed in-place, meaning that the free space is scattered throughout the heap, and you may need to scan the entire heap from left-to-right in order to find a spot to allocate something. There are data structures and algorithms that can make allocation faster than a linear scan, but they will never be as fast as the single pointer lookup necessary with a GC.</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Reference counting cannot collect cycles" dir="auto" class="heading" id="Reference_counting_cannot_collect_cycles"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Reference counting cannot collect cycles</h3><div class="heading-children"><div class="el-p"><p dir="auto">Objects that reference each other cyclically can thus cause memory leaks when their objects never get collected, resulting in the program running out of memory even though much of the heap could be cleaned up by a tracing garbage collector.</p></div><div class="el-p"><p dir="auto">For example, consider the following heap, identical to the one we started with, but with an additional edge from <code>bar</code> to <code>foo</code> (green), and with the edge from the stack to <code>bar</code> removed:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111191936.png" src="Pasted image 20250111191936.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111191936.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111191936.png"></span><br>
With reference counting, even though <code>foo</code> and <code>bar</code> cannot be reached by any external reference - they are "garbage" - each one still has a reference pointing at it from the other. Thus they will never get collected.</p></div><div class="el-p"><p dir="auto">But with a tracing garbage collector, a collection can traverse the reference graph (red), and copy <code>qux</code> and <code>baz</code> to the other half of the heap, leaving <code>foo</code> and <code>bar</code> behind as garbage, despite the reference cycle between them.</p></div><div class="el-p"><p dir="auto"><em>Garbage Collection</em> and <em>Reference Counting</em> have very different characteristics, and neither is strictly superior to the other in all scenarios. Many programming languages (e.g. Python) that use reference counting also have a backup tracing garbage collector that runs once in a while to clean up unreachable reference cycles and compact the heap, and most modern GCs (e.g. ZGC discussed below) use some reference-counting techniques as part of their implementation.</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Theoretical GC Performance" dir="auto" class="heading" id="Theoretical_GC_Performance"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Theoretical GC Performance</h2><div class="heading-children"><div class="el-p"><p dir="auto">Typically, GC performance focuses on two main aspects:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Overhead</strong>: what % of the time your program is spent collecting garbage, rather than real work. Lower is better.</li>
<li data-line="1" dir="auto"><strong>Pause Times</strong>: what is the longest time your program is completely paused while collecting garbage. Lower is better.</li>
</ul></div><div class="el-p"><p dir="auto">These two metrics are separate:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Some programs only care about throughput</strong>, e.g. if you only care about how long a big batch analysis takes to complete, and don’t care if it pauses in the middle to GC: you just want it to finish as soon as possible.</li>
<li data-line="1" dir="auto"><strong>Other programs only care about pause times</strong>, e.g. someone playing a videogame doesn’t care if it can run faster than their eye can perceive, but they do care that it does not freeze or pause for noticeable amounts of time while you are playing it.</li>
</ul></div><div class="el-p"><p dir="auto">Even from the limited description above, we can already make some interesting inferences about how the performance of a simple garbage collector will be like.</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Allocations in garbage collectors are cheap: when the heap is not yet full, we can just allocate things on the first empty slots on the right side of the heap and bump free-pointer, without having to scan the heap to find empty slots.</li>
<li data-line="1" dir="auto"><strong>Pause times should be proportional to the size of the live-set</strong>. That is because a collection involves tracing, copying, then updating the references within the live-set.</li>
<li data-line="2" dir="auto"><strong>Pause times would <em>not</em> depend on the amount of garbage to be collected</strong>. The collection we looked at above spend no time at all looking at or scanning for garbage objects, they simply all disappeared when their half of the heap was wiped out following a collection.</li>
<li data-line="3" dir="auto"><strong>Interval between collections is inversely proportional to free memory</strong>. We only need to run a collection when the garbage we allocate fills up the "extra" heap memory our program has on top of what is necessary to store the live-set.</li>
<li data-line="4" dir="auto">GC overhead is the pause time divided by the interval, or proportional to the extra memory and inversely proportional to the live-set size and heap size.</li>
</ol></div><div class="el-p"><p dir="auto">In other words:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><code>allocation_cost = O(1)</code></li>
<li data-line="1" dir="auto"><code>gc_pause_time = O(live-set)</code></li>
<li data-line="2" dir="auto"><code>gc_interval = O(heap-size - live-set)</code></li>
<li data-line="3" dir="auto"><code>gc_overhead = gc_pause_time / gc_interval</code></li>
<li data-line="4" dir="auto"><code>gc_overhead = O(live-set / (heap-size - live-set))</code></li>
</ul></div><div class="el-p"><p dir="auto">Even from this small conclusions, we can already see some unintuitive results:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>More memory does <em>not</em> reduce pause times!</strong> <code>gc_pause_time = O(live-set)</code>, and so pause times do not depend on how much <code>heap-size</code> you have.</li>
<li data-line="1" dir="auto"><strong>There is no point at which providing more memory does not improve GC overhead!</strong> <code>gc_overhead = O(live-set / (heap-size - live-set))</code>, so providing larger and larger <code>heap-size</code>s means less and less GC overhead, meaning a larger % of your program time is spent on useful work.</li>
<li data-line="2" dir="auto"><strong>Conversely, providing exactly as much memory as the program is the worst case possible!</strong> <code>gc_overhead = O(live-set / (heap-size - live-set))</code> when <code>heap-size = live-set</code> means <code>gc_interval = 0</code> and <code>gc_overhead = infinity</code>: the program will constantly need to run an expensive collections and have no time left to do actual work. Garbage collectors therefore <em>need</em> excess memory to work with, on top of the memory you would expect to need to allocate all the objects in your program.</li>
</ul></div><div class="el-p"><p dir="auto">Even from this theoretical analysis, we have already found a number of surprising results in how GCs perform over time. Let’s now see how this applies to some real-world garbage collectors included with the Java Virtual Machine.</p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Benchmarking JVM Garbage Collectors" dir="auto" class="heading" id="Benchmarking_JVM_Garbage_Collectors"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Benchmarking JVM Garbage Collectors</h2><div class="heading-children"><div class="el-p"><p dir="auto">Now that we have run through a theoretical introduction and analysis of how GCs work and how we would expect them to perform, let’s look at some small Java programs and monitor how garbage collection happens when using them. For this benchmark, we’ll be using the following Java program:</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GC</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token keyword">long</span> liveSetByteSize <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000000L</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> benchMillis <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> benchCount <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 0-490 array entries per object, * 4-bytes per entry,</span>
        <span class="token comment">// + 20 byte array header = average 1000 bytes per entry</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> maxObjectSize <span class="token operator">=</span> <span class="token number">490</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> averageObjectSize <span class="token operator">=</span> <span class="token punctuation">(</span>maxObjectSize <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token keyword">int</span> liveSetSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>liveSetByteSize <span class="token operator">/</span> averageObjectSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> maxPauseTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> throughputTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> benchCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> chunkSize <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> liveSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>liveSetSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> liveSetSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> liveSet<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>j <span class="token operator">%</span> maxObjectSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> maxPause <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">long</span> loopCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Random</span><span class="token punctuation">(</span><span class="token number">1337</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> liveSetIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span>startTime <span class="token operator">+</span> benchMillis <span class="token operator">&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>loopCount <span class="token operator">%</span> liveSetSize <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">long</span> loopStartTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                liveSetIndex <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>liveSetSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
                liveSet<span class="token punctuation">[</span>liveSetIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>liveSetIndex <span class="token operator">%</span> maxObjectSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">long</span> loopTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> loopStartTime<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>loopTime <span class="token operator">&gt;</span> maxPause<span class="token punctuation">)</span> maxPause <span class="token operator">=</span> loopTime<span class="token punctuation">;</span>
                loopCount<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">long</span> benchEndTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">long</span> bytesPerLoop <span class="token operator">=</span> maxObjectSize <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">;</span>
                throughputTotal <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">*</span> loopCount <span class="token operator">*</span> bytesPerLoop <span class="token operator">/</span> <span class="token number">1000000</span> <span class="token operator">/</span> <span class="token punctuation">(</span>benchEndTime <span class="token operator">-</span> startTime<span class="token punctuation">)</span> <span class="token operator">*</span> averageObjectSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
                maxPauseTotal <span class="token operator">+=</span> maxPause<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>liveSet<span class="token punctuation">[</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>liveSet<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">long</span> maxPause <span class="token operator">=</span> maxPauseTotal <span class="token operator">/</span> benchCount<span class="token punctuation">;</span>
        <span class="token keyword">long</span> throughput <span class="token operator">=</span> throughputTotal <span class="token operator">/</span> benchCount<span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"longest-gc: "</span> <span class="token operator">+</span> maxPause <span class="token operator">+</span> <span class="token string">" ms, throughput: "</span> <span class="token operator">+</span> throughput <span class="token operator">+</span> <span class="token string">" mb/s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This is a small Java program designed to do a rough benchmark of Java garbage collection performance. For each benchmark, it:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Starts off allocating a bunch of <code>int[]</code> arrays of varying size in liveSet, on average taking up 1000 bytes each.</li>
<li data-line="1" dir="auto">Loops continuously to allocate more <code>int[]</code>s and over-writes the references to older ones.</li>
<li data-line="2" dir="auto">Tracks how long each allocation takes to run: ideally it should be almost instant, but if that allocation triggers a GC it may take some time.</li>
</ul></div><div class="el-p"><p dir="auto">Lastly, we print out the two numbers we care about in a GC: the <code>maxPause</code> time in milliseconds, and the <code>throughput</code> it is able to handle in megabytes per second (<code>throughput</code> being the opposite of <code>overhead</code> we mentioned earlier).</p></div><div class="el-p"><p dir="auto">To be clear, this benchmark is <em>rough</em>. Performance will vary between runs, and on what hardware and software you run it (I ran it on a M1 Macbook Pro running Java 23). But the results should be clear even if the exact numbers will differ between runs.</p></div><div class="el-p"><p dir="auto">You can run this program via:</p></div><div class="el-pre"><pre><code data-line="0">&gt; java -Xmx1g GC.java 800 10000 5 # Default is -XX:+UseG1GC
&gt; java -Xmx1g -XX:+UseParallelGC GC.java 800 10000 5
&gt; java -Xmx1g -XX:+UseZGC GC.java 800 10000 5
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Above, <code>-Xmx1g</code> sets the heap size, the -XX: flags set the garbage collector, 800 sets the liveSet size (in megabytes), and 10000 and 5 set the duration and number of iterations to run the benchmark (here 10 seconds, 5 iterations). The measured pause times and allocation rate are averaged over those 5 iterations.</p></div><div class="el-p"><p dir="auto">I used the following Java program to run the benchmark for a range of inputs to collect the numbers shown below:</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token keyword">package</span> <span class="token namespace">mill<span class="token punctuation">.</span>main<span class="token punctuation">.</span>client</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Optional</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GCBenchmark</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> javaGcCombinations <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">"23"</span><span class="token punctuation">,</span> <span class="token string">"G1"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">"23"</span><span class="token punctuation">,</span> <span class="token string">"Z"</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> combination <span class="token operator">:</span> javaGcCombinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> javaVersion <span class="token operator">=</span> combination<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> gc <span class="token operator">=</span> combination<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Benchmarking javaVersion="</span> <span class="token operator">+</span> javaVersion <span class="token operator">+</span> <span class="token string">" gc="</span> <span class="token operator">+</span> gc<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> liveSets <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">3200</span><span class="token punctuation">,</span> <span class="token number">6400</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> heapSizes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">3200</span><span class="token punctuation">,</span> <span class="token number">6400</span><span class="token punctuation">,</span> <span class="token number">12800</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span> lists <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> liveSet <span class="token operator">:</span> liveSets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> innerList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> heapSize <span class="token operator">:</span> heapSizes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>liveSet <span class="token operator">&gt;=</span> heapSize<span class="token punctuation">)</span> innerList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span> innerList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">runBench</span><span class="token punctuation">(</span>liveSet<span class="token punctuation">,</span> heapSize<span class="token punctuation">,</span> javaVersion<span class="token punctuation">,</span> gc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                lists<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>innerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token function">renderTable</span><span class="token punctuation">(</span>liveSets<span class="token punctuation">,</span> heapSizes<span class="token punctuation">,</span> lists<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">renderTable</span><span class="token punctuation">(</span>liveSets<span class="token punctuation">,</span> heapSizes<span class="token punctuation">,</span> lists<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">runBench</span><span class="token punctuation">(</span><span class="token keyword">int</span> liveSet<span class="token punctuation">,</span> <span class="token keyword">int</span> heapSize<span class="token punctuation">,</span> <span class="token class-name">String</span> javaVersion<span class="token punctuation">,</span> <span class="token class-name">String</span> gc<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Benchmarking liveSet="</span> <span class="token operator">+</span> liveSet <span class="token operator">+</span> <span class="token string">" heapSize="</span> <span class="token operator">+</span> heapSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> javaBin <span class="token operator">=</span> <span class="token string">"/Users/lihaoyi/Downloads/amazon-corretto-"</span> <span class="token operator">+</span> javaVersion <span class="token operator">+</span> <span class="token string">".jdk/Contents/Home/bin/java"</span><span class="token punctuation">;</span>

        <span class="token class-name">ProcessBuilder</span> processBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProcessBuilder</span><span class="token punctuation">(</span>
            javaBin<span class="token punctuation">,</span> <span class="token string">"-Xmx"</span> <span class="token operator">+</span> heapSize <span class="token operator">+</span> <span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"-XX:+Use"</span> <span class="token operator">+</span> gc <span class="token operator">+</span> <span class="token string">"GC"</span><span class="token punctuation">,</span> <span class="token string">"GC.java"</span><span class="token punctuation">,</span> <span class="token string">""</span> <span class="token operator">+</span> liveSet<span class="token punctuation">,</span> <span class="token string">"10000"</span><span class="token punctuation">,</span> <span class="token string">"5"</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Process</span> process <span class="token operator">=</span> processBuilder<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        process<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> outputLines <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readAllBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Optional</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> result <span class="token operator">=</span> outputLines<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>line <span class="token operator">-&gt;</span> line<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"longest-gc: "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>line <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parts <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">", throughput: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>
                    parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">": "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token string">"error"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">renderTable</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> liveSets<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> heapSizes<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span> lists<span class="token punctuation">,</span> <span class="token keyword">int</span> columnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringBuilder</span> header <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">"| live-set\\heap-size | "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> heapSize <span class="token operator">:</span> heapSizes<span class="token punctuation">)</span> header<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>heapSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" mb | "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> liveSets<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">StringBuilder</span> row <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">"| "</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>liveSets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" mb | "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pair <span class="token operator">:</span> lists<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> row<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>pair<span class="token punctuation">[</span>columnIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" | "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3 heading-wrapper"><h3 data-heading="G1 Garbage Collector Benchmarks" dir="auto" class="heading" id="G1_Garbage_Collector_Benchmarks"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>G1 Garbage Collector Benchmarks</h3><div class="heading-children"><div class="el-p"><p dir="auto">Running this on the default GC (G1), we get the followings numbers:</p></div><div class="el-p"><p dir="auto">Pause Times:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111193311.png" src="Pasted image 20250111193311.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111193311.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111193311.png"></span></p></div><div class="el-p"><p dir="auto"><strong>Throughput</strong>:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250111193326.png" src="Pasted image 20250111193326.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250111193326.png" src="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/attachments/pasted-image-20250111193326.png"></span></p></div><div class="el-p"><p dir="auto">Some things worth noting with ZGC:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">In the lower heap-size benchmarks - with heap-size twice live-set - ZGC has worse pause times than the default G1GC (10s to 100s of milliseconds) but and worse throughput (2300-2600 mb/s rather than the 2800-3100 mb/s of G1GC).</li>
<li data-line="1" dir="auto">For larger <code>heap-size</code>s - 4 times the <code>live-set</code> and above - ZGC’s pause times drop to single-digit milliseconds (1-10 ms), much lower than those of G1GC.</li>
</ul></div><div class="el-p"><p dir="auto">As mentioned in the discussion on Theoretical GC Performance, for most garbage collectors pause times are proportional to the live set, and increasing the heap size does not help at all (and according to our G1 Garbage Collector Benchmarks, may even make things worse!). This can be problematic, because there are many use cases that cannot tolerate long GC pause times, but at the same time may require a significant amount of live data to be kept in memory, so shrinking the live-set is not possible.</p></div><div class="el-p"><p dir="auto">ZGC provides an option here, where if you are willing to provide <em>significantly</em> more memory than the default G1GC requires, perhaps twice as much, you can get your pause times from 10-100s of milliseconds down to 1-2 milliseconds. These pause times remain low for a wide range of heap sizes and live set sizes, and can be beneficial for a lot of applications that cannot afford to just randomly stop for 100ms at a time. But the extra memory requirement means it’s not a strict improvement, and it really depends on your use case whether the tradeoff is worth it.</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="GC Performance Takeaways&nbsp;GC" dir="auto" class="heading" id="GC_Performance_Takeaways&nbsp;GC"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>GC Performance Takeaways&nbsp;GC</h2><div class="heading-children"><div class="el-p"><p dir="auto">Now that we’ve studied garbage collections in theory, and looked at some concrete numbers, there are some interesting conclusions. First, the unintuitive things:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">
<p><strong>Adding more memory does <em>not improve</em> GC pause times</strong>. It may even make things worse! This is perhaps the most unintuitive thing about garbage collectors: it seems so obvious that problems with memory management would be solved by adding more memory, but we can see from our theoretical analysis above why that is not the case, and we verified that empirically in benchmarks.</p>
</li>
<li data-line="2" dir="auto">
<p><strong>Caching data <em>in-process</em> can make garbage collection pause times <em>worse</em>!</strong> If you have problems with GC pause times then caching things in-memory will increase the size of your <em>live-set</em> and therefore make your pause times even worse! "LRU" caches in particular are the worst case for garbage collectors, which are typically optimized for collecting recently-allocated short-lived objects. In contrast, caching things <em>out of process</em> does not have this problem. Caching can be worthwhile to reduce redundant computation, but it is not a solution to garbage collection problems.</p>
</li>
<li data-line="4" dir="auto">
<p><strong>There will never be an <em>exact</em> amount of memory that a garbage-collected application needs.</strong> You can <em>always</em> reduce-overhead/increase-throughput by providing more memory, to make GCs less and less frequent, leaving more time to do useful work. And you can usually provide less memory, at the cost of more and more frequent GCs. Exactly how much memory to provide is thus something you tweak and tune rather than something you can calculate exactly.</p>
</li>
<li data-line="6" dir="auto">
<p><strong>Fewer larger processes can have worse GC performance than more smaller processes!</strong> There are many ways in which consolidating smaller processes into larger ones can improve efficiency: less per-process overhead, eliminating <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Inter-process_communication" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Inter-process_communication" target="_blank">inter-process communication</a> cost, etc. But GC pause times scale with <em>total live set size</em>, so combining two smaller processes into one large one can make pause times <em>worse</em> than they were before. Even if the large process does the same thing as the smaller processes, it can suffer from worse GC pause times.</p>
</li>
<li data-line="8" dir="auto">
<p><strong>You can reduce pause times by reducing the <em>live-set</em></strong>. If you have very large in-process data structures, moving them somewhere else (e.g. into <a data-tooltip-position="top" aria-label="https://www.sqlite.org/" rel="noopener nofollow" class="external-link" href="https://www.sqlite.org/" target="_blank">SQLite</a>, <a data-tooltip-position="top" aria-label="https://github.com/redis/redis" rel="noopener nofollow" class="external-link" href="https://github.com/redis/redis" target="_blank">Redis</a>, or <a data-tooltip-position="top" aria-label="https://memcached.org/" rel="noopener nofollow" class="external-link" href="https://memcached.org/" target="_blank">Memcached</a>) would reduce the amount of objects the GC needs to trace and copy every collection, and reduce the pause times</p>
</li>
<li data-line="10" dir="auto">
<p><strong>Shorter-lived objects are faster to collect</strong>, due to most GCs being <em>generational</em>. This also ties into (1) above: caches tend to keep lots of long-lived objects in memory, which apart from slowing down collections due to the size of the live-set, <em>also</em> slows them down by missing out on the GC’s optimizations for short-lived objects.</p>
</li>
<li data-line="12" dir="auto">
<p><strong>Switch to the Z garbage collector lets you trade off memory for pause times.</strong> JVM programs are by default already very memory hungry compared to other languages (Go, Rust, etc.) and ZGC requires perhaps another 2x as much memory to work. But if you are willing to pay the cost, ZGC can bring pause times down from 50-500ms down to 1-5ms, which may make a big different for latency-sensitive applications.</p>
</li>
</ul></div><div class="el-p"><p dir="auto">The Java benchmarks above were run on one particular set of hardware on one version of the JVM, and the exact numbers will differ when run on other hardware or JVM versions. Nevertheless, the overall trends that you can see would remain the same, as would the take-aways of what you need to know to understand garbage collector performance.</p></div><div class="mod-footer mod-ui"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Understanding JVM Garbage Collector Performance"><div class="tree-item-contents heading-link" heading-name="Understanding JVM Garbage Collector Performance"><span class="tree-item-title">Understanding JVM Garbage Collector Performance</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#TL;DR"><div class="tree-item-contents heading-link" heading-name="TL;DR"><span class="tree-item-title">TL;DR</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#A_Theoretical_Garbage_Collector"><div class="tree-item-contents heading-link" heading-name="A Theoretical Garbage Collector"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">A Theoretical Garbage Collector</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Process_Memory"><div class="tree-item-contents heading-link" heading-name="Process Memory"><span class="tree-item-title">Process Memory</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#A_Simple_Garbage_Collector"><div class="tree-item-contents heading-link" heading-name="A Simple Garbage Collector"><span class="tree-item-title">A Simple Garbage Collector</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Compared_to_Reference_Counting"><div class="tree-item-contents heading-link" heading-name="Compared to Reference Counting"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Compared to Reference Counting</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Reference_counting_does_not_compact_the_heap"><div class="tree-item-contents heading-link" heading-name="Reference counting does not compact the heap"><span class="tree-item-title">Reference counting does not compact the heap</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Reference_counting_cannot_collect_cycles"><div class="tree-item-contents heading-link" heading-name="Reference counting cannot collect cycles"><span class="tree-item-title">Reference counting cannot collect cycles</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Theoretical_GC_Performance"><div class="tree-item-contents heading-link" heading-name="Theoretical GC Performance"><span class="tree-item-title">Theoretical GC Performance</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#Benchmarking_JVM_Garbage_Collectors"><div class="tree-item-contents heading-link" heading-name="Benchmarking JVM Garbage Collectors"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Benchmarking JVM Garbage Collectors</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#G1_Garbage_Collector_Benchmarks"><div class="tree-item-contents heading-link" heading-name="G1 Garbage Collector Benchmarks"><span class="tree-item-title">G1 Garbage Collector Benchmarks</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="computer-science/programming-language/jvm/understanding-jvm-garbage-collector-performance/understanding-jvm-garbage-collector-performance.html#GC_Performance_Takeaways&nbsp;GC"><div class="tree-item-contents heading-link" heading-name="GC Performance Takeaways&nbsp;GC"><span class="tree-item-title">GC Performance Takeaways&nbsp;GC</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>